<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lección 13: Concepto de Dualidad | Matemáticas Visuales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glow-text { text-shadow: 0 0 20px rgba(168, 85, 247, 0.5); }
        .progress-bar { background: linear-gradient(90deg, #a855f7, #22d3ee); }
        .katex { color: inherit; font-size: 1.1em; }
    </style>
</head>
<body class="bg-black text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="border-b border-gray-900 bg-black/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <nav class="text-xs text-gray-600 mb-1">
                        <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                        <span class="mx-1">/</span>
                        <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
                        <span class="mx-1">/</span>
                        <span class="text-gray-500">Módulo 03</span>
                    </nav>
                    <h1 class="text-lg font-light">
                        <span class="text-violet-400 font-medium glow-text">Lección 13</span> — Concepto de Dualidad
                    </h1>
                </div>
                <nav class="flex gap-2 text-sm">
                    <a href="../modulo-02/leccion-12.html" class="px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 transition">← Anterior</a>
                    <a href="./leccion-14.html" class="px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 transition">Siguiente →</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-1">
                <div class="bg-gray-950 border border-gray-900 rounded-2xl p-6 sticky top-24">
                    <h3 class="text-lg font-semibold mb-4 text-cyan-400">Módulo 03</h3>
                    <p class="text-sm text-gray-500 mb-4">Dualidad y Simetría</p>

                    <div class="mb-6">
                        <div class="flex justify-between text-xs text-gray-400 mb-2">
                            <span>Progreso</span>
                            <span>1/6</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-2">
                            <div class="progress-bar h-2 rounded-full" style="width: 16.6%"></div>
                        </div>
                    </div>

                    <nav class="space-y-2">
                        <a href="./leccion-13.html" class="block px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 text-sm">13. Concepto de Dualidad</a>
                        <a href="./leccion-14.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">14. El Tetraedro Autodual</a>
                        <a href="./leccion-15.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">15. Cubo y Octaedro</a>
                        <a href="./leccion-16.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">16. Dodecaedro e Icosaedro</a>
                        <a href="./leccion-17.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">17. Grupos de Simetría</a>
                        <a href="./leccion-18.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">18. Ejes y Planos de Simetría</a>
                    </nav>
                </div>
            </aside>

            <!-- Content -->
            <main class="lg:col-span-3">
                <article class="bg-gray-950 border border-gray-900 rounded-2xl p-8">
                    <div class="mb-8">
                        <span class="text-cyan-400 text-sm font-medium">Lección 13</span>
                        <h2 class="text-3xl font-light mt-2 mb-4">
                            <span class="text-violet-400 font-medium glow-text">Concepto</span> de Dualidad
                        </h2>
                        <p class="text-gray-400 text-lg">La transformación que intercambia caras y vértices revela una estructura oculta en los poliedros.</p>
                    </div>

                    <!-- La Construcción Dual -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">La Construcción Dual</h3>
                        <p class="text-gray-300 mb-4">
                            Dado un poliedro \(P\), su <strong class="text-white">dual</strong> \(P^*\) se construye así:
                        </p>
                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 mb-4">
                            <ol class="list-decimal list-inside space-y-3 text-gray-300">
                                <li>Para cada <strong>cara</strong> de \(P\), colocar un <strong>vértice</strong> de \(P^*\) en su centroide.</li>
                                <li>Dos vértices de \(P^*\) se conectan con una <strong>arista</strong> si las caras correspondientes de \(P\) comparten una arista.</li>
                                <li>Las aristas de \(P^*\) que rodean un vértice \(v\) de \(P\) forman una <strong>cara</strong> de \(P^*\).</li>
                            </ol>
                        </div>
                        <p class="text-gray-300 mb-4">
                            La dualidad intercambia el rol de caras y vértices mientras preserva las relaciones de adyacencia. Este intercambio tiene consecuencias algebraicas precisas.
                        </p>
                    </section>

                    <!-- Qué se intercambia -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Qué se Intercambia, Qué se Conserva</h3>
                        <p class="text-gray-300 mb-4">
                            Si \(P\) tiene parámetros de Schläfli \(\{p, q\}\) con \(V\) vértices, \(E\) aristas y \(F\) caras, su dual \(P^*\) satisface:
                        </p>

                        $$ V^* = F, \quad E^* = E, \quad F^* = V $$

                        <p class="text-gray-300 mb-4">
                            <strong class="text-white">Las aristas se conservan.</strong> Cada arista de \(P\) separa exactamente dos caras y conecta exactamente dos vértices. En \(P^*\), esa misma arista conecta los centroides de esas dos caras (ahora vértices de \(P^*\)). Hay una biyección natural entre las aristas de \(P\) y las de \(P^*\).
                        </p>

                        <p class="text-gray-300 mb-4">
                            En la notación de Schläfli, la dualidad simplemente <strong>invierte los parámetros</strong>:
                        </p>

                        $$ \{p, q\}^* = \{q, p\} $$

                        <p class="text-gray-300 mb-4">
                            Esto es porque en \(P^*\), cada cara rodea un vértice original donde concurrían \(q\) caras, así que cada cara del dual tiene \(q\) lados. Y en cada vértice del dual (centroide de una cara \(p\)-gonal), concurren \(p\) caras.
                        </p>
                    </section>

                    <!-- Verificación con Euler -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Verificación con la Fórmula de Euler</h3>
                        <p class="text-gray-300 mb-4">
                            Si \(P\) satisface \(V - E + F = 2\), ¿qué ocurre con \(P^*\)?
                        </p>

                        $$ V^* - E^* + F^* = F - E + V = V - E + F = 2 \quad \checkmark $$

                        <p class="text-gray-300 mb-4">
                            La característica de Euler es invariante bajo dualidad. Esto no es coincidencia: la dualidad preserva la topología del poliedro (ambos son homeomorfos a la esfera).
                        </p>

                        <p class="text-gray-300 mb-4">
                            Recordemos las fórmulas de conteo dual del Módulo 2:
                        </p>

                        $$ pF = 2E \quad \text{(conteo por caras)}, \qquad qV = 2E \quad \text{(conteo por vértices)} $$

                        <p class="text-gray-300 mb-4">
                            En el dual \(\{q, p\}\):
                        </p>

                        $$ qF^* = 2E^* \implies qV = 2E \quad \checkmark $$
                        $$ pV^* = 2E^* \implies pF = 2E \quad \checkmark $$

                        <p class="text-gray-300">
                            Las relaciones de conteo de \(P\) y \(P^*\) son la misma ecuación leída al revés.
                        </p>
                    </section>

                    <!-- Las tres familias duales -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Las Tres Familias Duales</h3>
                        <p class="text-gray-300 mb-4">
                            Los 5 sólidos platónicos se organizan en tres familias bajo dualidad:
                        </p>
                        <div class="overflow-x-auto mb-4">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Sólido</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\{p,q\}\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">V</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">E</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">F</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Dual</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\{q,p\}\)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 text-yellow-400">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,3}</td>
                                        <td class="px-4 py-2 text-center">4</td>
                                        <td class="px-4 py-2 text-center">6</td>
                                        <td class="px-4 py-2 text-center">4</td>
                                        <td class="px-4 py-2 text-center text-yellow-400">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,3}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 text-violet-400">Cubo</td>
                                        <td class="px-4 py-2 text-center mono">{4,3}</td>
                                        <td class="px-4 py-2 text-center">8</td>
                                        <td class="px-4 py-2 text-center">12</td>
                                        <td class="px-4 py-2 text-center">6</td>
                                        <td class="px-4 py-2 text-center text-cyan-400">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,4}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 text-cyan-400">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,4}</td>
                                        <td class="px-4 py-2 text-center">6</td>
                                        <td class="px-4 py-2 text-center">12</td>
                                        <td class="px-4 py-2 text-center">8</td>
                                        <td class="px-4 py-2 text-center text-violet-400">Cubo</td>
                                        <td class="px-4 py-2 text-center mono">{4,3}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 text-green-400">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono">{5,3}</td>
                                        <td class="px-4 py-2 text-center">20</td>
                                        <td class="px-4 py-2 text-center">30</td>
                                        <td class="px-4 py-2 text-center">12</td>
                                        <td class="px-4 py-2 text-center text-red-400">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,5}</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2 text-red-400">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono">{3,5}</td>
                                        <td class="px-4 py-2 text-center">12</td>
                                        <td class="px-4 py-2 text-center">30</td>
                                        <td class="px-4 py-2 text-center">20</td>
                                        <td class="px-4 py-2 text-center text-green-400">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono">{5,3}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-gray-300">
                            Observa que \(E\) es siempre igual en cada par. El tetraedro, con \(p = q = 3\), es <strong class="text-white">autodual</strong>: intercambiar no cambia nada.
                        </p>
                    </section>

                    <!-- El dual del dual -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">El Dual del Dual: Involución</h3>
                        <p class="text-gray-300 mb-4">
                            Aplicar dualidad dos veces recupera el poliedro original (salvo escala):
                        </p>

                        $$ (P^*)^* \cong P $$

                        <p class="text-gray-300 mb-4">
                            <strong class="text-white">Demostración:</strong> los vértices de \((P^*)^*\) son los centroides de las caras de \(P^*\). Pero cada cara de \(P^*\) rodea un vértice \(v\) de \(P\), y su centroide se sitúa sobre \(v\) (no exactamente en \(v\), sino a lo largo de la línea del centro al vértice). El resultado es un poliedro combinatoriamente idéntico a \(P\), escalado hacia el centro.
                        </p>

                        <p class="text-gray-300 mb-4">
                            Algebraicamente: \(\{p,q\}^{**} = \{q,p\}^* = \{p,q\}\). La dualidad es una <strong>involución</strong> en el conjunto de sólidos platónicos.
                        </p>
                    </section>

                    <!-- La Midsphere -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">La Midsphere: El Puente entre Duales</h3>
                        <p class="text-gray-300 mb-4">
                            Existe una esfera especial, la <strong class="text-white">midsphere</strong> (o esfera interescalar), que es tangente a <em>todas</em> las aristas de \(P\). El punto de tangencia en cada arista es exactamente el punto donde la arista correspondiente de \(P^*\) la cruza perpendicularmente.
                        </p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 mb-4">
                            <p class="text-gray-300 mb-2"><strong class="text-cyan-400">Teorema de la midsphere:</strong></p>
                            <p class="text-gray-300">
                                Un poliedro convexo \(P\) y su dual \(P^*\) comparten la misma midsphere de radio \(\rho\). Cada arista de \(P\) cruza perpendicularmente la arista correspondiente de \(P^*\), y el punto de cruce está sobre la midsphere.
                            </p>
                        </div>

                        <p class="text-gray-300 mb-4">
                            Para un poliedro regular \(\{p,q\}\) con arista \(a\), el radio de la midsphere es:
                        </p>

                        $$ \rho = \frac{a}{2} \cdot \frac{\cos(\pi/q)}{\sin(\pi/h)} $$

                        <p class="text-gray-300 mb-4">
                            donde \(h\) es el número de Coxeter definido por \(\frac{1}{h} = \frac{1}{2} - \frac{1}{p} - \frac{1}{q}\). Para el cubo: \(h = 6\), así que \(\rho = \frac{a}{2} \cdot \frac{\cos(\pi/3)}{\sin(\pi/6)} = \frac{a}{2}\). En efecto, la midsphere del cubo unitario tiene radio \(\frac{1}{2}\).
                        </p>

                        <p class="text-gray-300">
                            La relación entre las esferas es: \(r \le \rho \le R\), donde \(r\) es el radio inscrito y \(R\) el circunscrito. La midsphere está entre ambas.
                        </p>
                    </section>

                    <!-- Perpendicularidad de aristas -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Perpendicularidad de Aristas Duales</h3>
                        <p class="text-gray-300 mb-4">
                            Cada arista de \(P\) es perpendicular a la arista correspondiente de \(P^*\). Verifiquémoslo para el cubo y el octaedro.
                        </p>
                        <p class="text-gray-300 mb-4">
                            Cubo con vértices \((\pm 1, \pm 1, \pm 1)\). Tomemos la arista de \((1,1,-1)\) a \((1,1,1)\), con dirección \(\vec{u} = (0,0,2)\).
                        </p>
                        <p class="text-gray-300 mb-4">
                            Esta arista separa las caras en \(y = 1\) (centroide \((0,1,0)\)) y \(x = 1\) (centroide \((1,0,0)\)). La arista dual conecta estos centroides con dirección \(\vec{v} = (1,-1,0)\).
                        </p>

                        $$ \vec{u} \cdot \vec{v} = (0)(1) + (0)(-1) + (2)(0) = 0 \quad \checkmark $$

                        <p class="text-gray-300">
                            Perpendiculares. Esto ocurre porque ambas aristas pasan por el punto de tangencia sobre la midsphere, y la esfera es localmente plana (perpendicular al radio) en ese punto.
                        </p>
                    </section>

                    <!-- Dualidad en el mapa {p,q} -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Dualidad en el Mapa \(\{p,q\}\)</h3>
                        <p class="text-gray-300 mb-4">
                            En la Lección 10 construimos el mapa de soluciones de \((p-2)(q-2) < 4\). La dualidad actúa como <strong>reflexión respecto a la diagonal</strong> \(p = q\):
                        </p>

                        <div class="overflow-x-auto mb-4">
                            <table class="text-sm text-gray-300 mx-auto">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-3 py-2 text-gray-500"></th>
                                        <th class="px-3 py-2 text-center text-gray-400 mono">q=3</th>
                                        <th class="px-3 py-2 text-center text-gray-400 mono">q=4</th>
                                        <th class="px-3 py-2 text-center text-gray-400 mono">q=5</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-3 py-2 text-gray-400 mono">p=3</td>
                                        <td class="px-3 py-2 text-center text-yellow-400">T</td>
                                        <td class="px-3 py-2 text-center text-cyan-400">O</td>
                                        <td class="px-3 py-2 text-center text-red-400">I</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-3 py-2 text-gray-400 mono">p=4</td>
                                        <td class="px-3 py-2 text-center text-violet-400">C</td>
                                        <td class="px-3 py-2 text-center text-gray-600">--</td>
                                        <td class="px-3 py-2 text-center text-gray-600">--</td>
                                    </tr>
                                    <tr>
                                        <td class="px-3 py-2 text-gray-400 mono">p=5</td>
                                        <td class="px-3 py-2 text-center text-green-400">D</td>
                                        <td class="px-3 py-2 text-center text-gray-600">--</td>
                                        <td class="px-3 py-2 text-center text-gray-600">--</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300 mb-4">
                            El tetraedro T está en la diagonal (\(p = q = 3\)), por lo que es invariante. El cubo C en \((4,3)\) se refleja al octaedro O en \((3,4)\). El dodecaedro D en \((5,3)\) se refleja al icosaedro I en \((3,5)\).
                        </p>
                        <p class="text-gray-300">
                            La dualidad es un automorfismo de orden 2 del mapa \(\{p,q\}\).
                        </p>
                    </section>

                    <!-- Dualidad preserva simetrías -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Dualidad y Simetrías</h3>
                        <p class="text-gray-300 mb-4">
                            Toda simetría (rotación o reflexión) de \(P\) es automáticamente una simetría de \(P^*\), y viceversa:
                        </p>

                        $$ \text{Sym}(P) = \text{Sym}(P^*) $$

                        <p class="text-gray-300 mb-4">
                            <strong class="text-white">Argumento:</strong> si una rotación \(R\) envía cada cara de \(P\) a otra cara de \(P\), entonces envía el centroide de cada cara al centroide de la imagen, preservando la adyacencia. Por tanto \(R\) permuta los vértices de \(P^*\) respetando aristas: es una simetría de \(P^*\).
                        </p>

                        <p class="text-gray-300">
                            Esto explica por qué el cubo y el octaedro comparten el grupo \(O_h\) (48 elementos), y el dodecaedro e icosaedro comparten \(I_h\) (120 elementos). Exploraremos estos grupos en las Lecciones 17 y 18.
                        </p>
                    </section>

                    <!-- Ejercicios -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">Ejercicios</h3>
                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4">
                            <div>
                                <p class="text-gray-300"><strong class="text-white">1.</strong> Un poliedro convexo tiene \(V = 10\), \(E = 15\), \(F = 7\). ¿Cuántos vértices, aristas y caras tiene su dual?</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">2.</strong> Demuestra que la dualidad preserva la fórmula de Euler: si \(V - E + F = 2\), entonces \(V^* - E^* + F^* = 2\).</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">3.</strong> ¿Bajo qué condición sobre \(p\) y \(q\) es \(\{p,q\}\) autodual? Justifica que solo \(\{3,3\}\) satisface la condición entre los sólidos platónicos.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">4.</strong> Verifica la perpendicularidad de aristas duales para otra arista del cubo: toma la arista de \((1,-1,-1)\) a \((1,1,-1)\) y encuentra la arista dual correspondiente. Comprueba que el producto escalar es 0.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">5.</strong> El mapa \(\{p,q\}\) tiene 5 entradas válidas. La dualidad las refleja respecto a \(p = q\). ¿Cuántas órbitas distintas tiene esta acción? ¿Cuáles son?</p>
                            </div>
                        </div>
                    </section>

                    <!-- LAB -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">LAB: Construcción del Dual</h3>
                        <p class="text-gray-400 mb-4">Selecciona un sólido y observa cómo se construye su dual desde los centroides de las caras. Usa el slider para interpolar entre el sólido y su dual.</p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                            <!-- Controls -->
                            <div class="flex flex-wrap gap-2 p-4 border-b border-gray-800">
                                <button onclick="selectSolid(0)" class="solid-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/10 border border-violet-500 text-violet-400" data-idx="0">Tetraedro</button>
                                <button onclick="selectSolid(1)" class="solid-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400" data-idx="1">Cubo</button>
                                <button onclick="selectSolid(2)" class="solid-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400" data-idx="2">Octaedro</button>
                                <button onclick="selectSolid(3)" class="solid-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400" data-idx="3">Dodecaedro</button>
                                <button onclick="selectSolid(4)" class="solid-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400" data-idx="4">Icosaedro</button>
                            </div>
                            <div class="flex items-center gap-4 px-4 py-3 border-b border-gray-800">
                                <span class="text-sm text-gray-400 w-24">Dual: <span id="dual-val" class="text-violet-400 mono">0%</span></span>
                                <input type="range" id="dual-slider" min="0" max="100" value="0" class="flex-1 accent-violet-500">
                                <label class="text-sm text-gray-400 flex items-center gap-2">
                                    <input type="checkbox" id="show-mid" class="accent-cyan-500"> Midsphere
                                </label>
                            </div>
                            <!-- Info -->
                            <div id="info-bar" class="flex justify-center gap-6 px-4 py-2 border-b border-gray-800 text-sm mono">
                                <span class="text-gray-400">V=<span id="iv" class="text-violet-400">4</span></span>
                                <span class="text-gray-400">E=<span id="ie" class="text-violet-400">6</span></span>
                                <span class="text-gray-400">F=<span id="if" class="text-violet-400">4</span></span>
                                <span class="text-gray-500">|</span>
                                <span class="text-gray-400">V*=<span id="iv2" class="text-cyan-400">4</span></span>
                                <span class="text-gray-400">E*=<span id="ie2" class="text-cyan-400">6</span></span>
                                <span class="text-gray-400">F*=<span id="if2" class="text-cyan-400">4</span></span>
                            </div>
                            <!-- Canvas -->
                            <canvas id="lab-canvas" class="w-full bg-black" style="height:480px;"></canvas>
                        </div>
                    </section>

                    <!-- Navigation -->
                    <div class="mt-12 pt-8 border-t border-gray-800 flex justify-between items-center">
                        <a href="../modulo-02/leccion-12.html" class="px-6 py-3 bg-gray-900 hover:bg-gray-800 rounded-lg text-gray-300 transition">
                            ← Módulo 2
                        </a>
                        <a href="./leccion-14.html" class="px-6 py-3 bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 rounded-lg transition">
                            Siguiente: El Tetraedro Autodual →
                        </a>
                    </div>
                </article>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-gray-900 py-6 mt-12">
        <div class="max-w-6xl mx-auto px-6">
            <nav class="text-xs text-gray-600 text-center mb-2">
                <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                <span class="mx-1">/</span>
                <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                <span class="mx-1">/</span>
                <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                <span class="mx-1">/</span>
                <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
            </nav>
            <p class="text-center text-gray-700 text-sm mono">Matemáticas Visuales — De Platón a 4D</p>
        </div>
    </footer>

    <!-- Three.js LAB -->
    <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
    <script>
    (function(){
        var canvas = document.getElementById('lab-canvas');
        var W = canvas.clientWidth, H = canvas.clientHeight;
        canvas.width = W * 2; canvas.height = H * 2;

        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(45, W/H, 0.1, 100);
        camera.position.set(0, 0, 5);

        var renderer = new THREE.WebGLRenderer({canvas: canvas, antialias: true, alpha: true});
        renderer.setSize(W, H);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setClearColor(0x000000);

        var group = new THREE.Group();
        scene.add(group);

        var PHI = (1 + Math.sqrt(5)) / 2;

        // Solid definitions: vertices and faces (triangulated)
        var solids = [
            // 0: Tetrahedron
            {name:'Tetraedro', pq:[3,3], V:4, E:6, F:4,
             verts:[[1,1,1],[1,-1,-1],[-1,1,-1],[-1,-1,1]],
             faces:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]],
             polyFaces:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]]},
            // 1: Cube
            {name:'Cubo', pq:[4,3], V:8, E:12, F:6,
             verts:[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]],
             faces:[[0,1,2,3],[4,7,6,5],[0,4,5,1],[2,6,7,3],[0,3,7,4],[1,5,6,2]],
             polyFaces:[[0,1,2,3],[4,7,6,5],[0,4,5,1],[2,6,7,3],[0,3,7,4],[1,5,6,2]]},
            // 2: Octahedron
            {name:'Octaedro', pq:[3,4], V:6, E:12, F:8,
             verts:[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],
             faces:[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,4,2],[1,3,4],[1,5,3],[1,2,5]],
             polyFaces:[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,4,2],[1,3,4],[1,5,3],[1,2,5]]},
            // 3: Dodecahedron
            {name:'Dodecaedro', pq:[5,3], V:20, E:30, F:12,
             verts:(function(){
                 var v=[], p=PHI, ip=1/PHI;
                 [1,-1].forEach(function(a){[1,-1].forEach(function(b){[1,-1].forEach(function(c){
                     v.push([a,b,c]);
                 });});});
                 [1,-1].forEach(function(a){[1,-1].forEach(function(b){
                     v.push([0,a*ip,b*p]);
                     v.push([a*ip,b*p,0]);
                     v.push([b*p,0,a*ip]);
                 });});
                 return v;
             })(),
             faces:[], polyFaces:[]},
            // 4: Icosahedron
            {name:'Icosaedro', pq:[3,5], V:12, E:30, F:20,
             verts:(function(){
                 var v=[], p=PHI;
                 [1,-1].forEach(function(a){[1,-1].forEach(function(b){
                     v.push([0,a,b*p]);
                     v.push([a,b*p,0]);
                     v.push([b*p,0,a]);
                 });});
                 return v;
             })(),
             faces:[], polyFaces:[]}
        ];

        // Normalize all vertices to roughly unit radius
        solids.forEach(function(s){
            var maxR = 0;
            s.verts.forEach(function(v){
                var r = Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);
                if(r>maxR) maxR=r;
            });
            var sc = 1.5/maxR;
            s.verts = s.verts.map(function(v){return [v[0]*sc,v[1]*sc,v[2]*sc];});
        });

        // Build faces for dodecahedron and icosahedron via convex hull approach
        function buildFaces(solid) {
            var verts = solid.verts;
            var n = verts.length;
            // Find edge length (shortest distance)
            var minD = Infinity;
            for(var i=0;i<n;i++) for(var j=i+1;j<n;j++){
                var dx=verts[i][0]-verts[j][0],dy=verts[i][1]-verts[j][1],dz=verts[i][2]-verts[j][2];
                var d=Math.sqrt(dx*dx+dy*dy+dz*dz);
                if(d<minD) minD=d;
            }
            var thresh = minD*1.05;
            // Build adjacency
            var adj = [];
            for(var i=0;i<n;i++) adj[i]=[];
            for(var i=0;i<n;i++) for(var j=i+1;j<n;j++){
                var dx=verts[i][0]-verts[j][0],dy=verts[i][1]-verts[j][1],dz=verts[i][2]-verts[j][2];
                if(Math.sqrt(dx*dx+dy*dy+dz*dz)<thresh){adj[i].push(j);adj[j].push(i);}
            }
            // Find triangular faces: for each edge, find common neighbors
            var faceSet = {};
            var faces = [];
            for(var i=0;i<n;i++){
                for(var ai=0;ai<adj[i].length;ai++){
                    var j=adj[i][ai];
                    if(j<=i) continue;
                    for(var bi=0;bi<adj[i].length;bi++){
                        var k=adj[i][bi];
                        if(k<=j) continue;
                        if(adj[j].indexOf(k)>=0){
                            var f=[i,j,k].sort(function(a,b){return a-b;});
                            var key=f.join(',');
                            if(!faceSet[key]){faceSet[key]=1;faces.push(f);}
                        }
                    }
                }
            }
            // Orient faces outward
            faces.forEach(function(f){
                var a=verts[f[0]],b=verts[f[1]],c=verts[f[2]];
                var ux=b[0]-a[0],uy=b[1]-a[1],uz=b[2]-a[2];
                var vx=c[0]-a[0],vy=c[1]-a[1],vz=c[2]-a[2];
                var nx=uy*vz-uz*vy,ny=uz*vx-ux*vz,nz=ux*vy-uy*vx;
                var cx2=(a[0]+b[0]+c[0])/3, cy2=(a[1]+b[1]+c[1])/3, cz2=(a[2]+b[2]+c[2])/3;
                if(nx*cx2+ny*cy2+nz*cz2<0){var tmp=f[1];f[1]=f[2];f[2]=tmp;}
            });
            if(solid.pq[0]===3){
                solid.faces=faces;
                solid.polyFaces=faces;
            } else {
                // Dodecahedron: group triangles into pentagons
                // Each pentagon shares edges; use face adjacency
                solid.faces=faces; // triangulated for rendering
                // Build polyFaces by merging coplanar triangles
                var groups=[], used={};
                for(var fi=0;fi<faces.length;fi++){
                    if(used[fi]) continue;
                    var a=verts[faces[fi][0]],b=verts[faces[fi][1]],c=verts[faces[fi][2]];
                    var ux=b[0]-a[0],uy=b[1]-a[1],uz=b[2]-a[2];
                    var vx=c[0]-a[0],vy=c[1]-a[1],vz=c[2]-a[2];
                    var nx=uy*vz-uz*vy,ny=uz*vx-ux*vz,nz=ux*vy-uy*vx;
                    var nl=Math.sqrt(nx*nx+ny*ny+nz*nz);
                    nx/=nl;ny/=nl;nz/=nl;
                    var dd=nx*a[0]+ny*a[1]+nz*a[2];
                    var grp=[fi]; used[fi]=1;
                    for(var fj=fi+1;fj<faces.length;fj++){
                        if(used[fj]) continue;
                        var p=verts[faces[fj][0]];
                        var dd2=nx*p[0]+ny*p[1]+nz*p[2];
                        var a2=verts[faces[fj][0]],b2=verts[faces[fj][1]],c2=verts[faces[fj][2]];
                        var ux2=b2[0]-a2[0],uy2=b2[1]-a2[1],uz2=b2[2]-a2[2];
                        var vx2=c2[0]-a2[0],vy2=c2[1]-a2[1],vz2=c2[2]-a2[2];
                        var nx2=uy2*vz2-uz2*vy2,ny2=uz2*vx2-ux2*vz2,nz2=ux2*vy2-uy2*vx2;
                        var nl2=Math.sqrt(nx2*nx2+ny2*ny2+nz2*nz2);
                        nx2/=nl2;ny2/=nl2;nz2/=nl2;
                        var dot=Math.abs(nx*nx2+ny*ny2+nz*nz2);
                        if(dot>0.999 && Math.abs(dd-dd2)<0.01){grp.push(fj);used[fj]=1;}
                    }
                    // Collect unique verts
                    var vs={};
                    grp.forEach(function(gi){faces[gi].forEach(function(vi){vs[vi]=1;});});
                    groups.push(Object.keys(vs).map(Number));
                }
                solid.polyFaces=groups;
            }
        }
        buildFaces(solids[3]);
        buildFaces(solids[4]);

        // Compute face centroids for dual vertices
        function faceCentroids(s){
            return s.polyFaces.map(function(f){
                var cx=0,cy=0,cz=0;
                f.forEach(function(i){cx+=s.verts[i][0];cy+=s.verts[i][1];cz+=s.verts[i][2];});
                var n=f.length;
                return [cx/n,cy/n,cz/n];
            });
        }

        // Build edge list from faces
        function edgeList(faces){
            var set={}, edges=[];
            faces.forEach(function(f){
                for(var i=0;i<f.length;i++){
                    var a=f[i], b=f[(i+1)%f.length];
                    var key=Math.min(a,b)+','+Math.max(a,b);
                    if(!set[key]){set[key]=1;edges.push([a,b]);}
                }
            });
            return edges;
        }

        // Build dual edge list: connect centroids of adjacent faces
        function dualEdges(s){
            // Two faces are adjacent if they share an edge
            var edgeFace={};
            s.polyFaces.forEach(function(f,fi){
                for(var i=0;i<f.length;i++){
                    var a=f[i],b=f[(i+1)%f.length];
                    var key=Math.min(a,b)+','+Math.max(a,b);
                    if(!edgeFace[key]) edgeFace[key]=[];
                    edgeFace[key].push(fi);
                }
            });
            var edges=[];
            Object.keys(edgeFace).forEach(function(k){
                var fs=edgeFace[k];
                if(fs.length===2) edges.push([fs[0],fs[1]]);
            });
            return edges;
        }

        // Current state
        var currentIdx = 0;
        var dualT = 0; // 0=solid, 1=dual
        var solidMeshGroup, dualMeshGroup, midsphereMesh;

        function buildMesh(vertices, edges, color, opacity){
            var g = new THREE.Group();
            // Edges
            edges.forEach(function(e){
                var geo = new THREE.BufferGeometry();
                var v = new Float32Array([
                    vertices[e[0]][0],vertices[e[0]][1],vertices[e[0]][2],
                    vertices[e[1]][0],vertices[e[1]][1],vertices[e[1]][2]
                ]);
                geo.setAttribute('position', new THREE.BufferAttribute(v,3));
                var mat = new THREE.LineBasicMaterial({color:color, transparent:true, opacity:opacity});
                g.add(new THREE.Line(geo, mat));
            });
            // Vertices
            var pts = [];
            vertices.forEach(function(v){pts.push(v[0],v[1],v[2]);});
            var pg = new THREE.BufferGeometry();
            pg.setAttribute('position', new THREE.Float32BufferAttribute(pts,3));
            var pm = new THREE.PointsMaterial({color:color, size:5, sizeAttenuation:false, transparent:true, opacity:Math.min(1,opacity+0.2)});
            g.add(new THREE.Points(pg, pm));
            return g;
        }

        function rebuild(){
            // Clear
            while(group.children.length) group.remove(group.children[0]);

            var s = solids[currentIdx];
            var centroids = faceCentroids(s);
            var sEdges = edgeList(s.polyFaces);
            var dEdges = dualEdges(s);

            // Interpolated vertices
            var t = dualT;

            // Original solid: fade out as t increases
            var solidAlpha = 1 - t * 0.7;
            solidMeshGroup = buildMesh(s.verts, sEdges, 0xa78bfa, solidAlpha);
            group.add(solidMeshGroup);

            // Dual: fade in as t increases
            if(t > 0){
                // Interpolate dual vertices from centroids toward full dual scale
                var dualVerts = centroids.map(function(c){
                    // Scale dual to similar size as original
                    var maxR=0;
                    centroids.forEach(function(cc){var r=Math.sqrt(cc[0]*cc[0]+cc[1]*cc[1]+cc[2]*cc[2]);if(r>maxR)maxR=r;});
                    var maxRO=0;
                    s.verts.forEach(function(v){var r=Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);if(r>maxRO)maxRO=r;});
                    var sc=maxRO/maxR;
                    return [c[0]*sc, c[1]*sc, c[2]*sc];
                });
                var dualAlpha = t * 0.9;
                dualMeshGroup = buildMesh(dualVerts, dEdges, 0x22d3ee, dualAlpha);
                group.add(dualMeshGroup);
            }

            // Midsphere
            if(document.getElementById('show-mid').checked){
                // Compute midsphere radius: average distance from center to edge midpoints
                var totalR=0, count=0;
                sEdges.forEach(function(e){
                    var mx=(s.verts[e[0]][0]+s.verts[e[1]][0])/2;
                    var my=(s.verts[e[0]][1]+s.verts[e[1]][1])/2;
                    var mz=(s.verts[e[0]][2]+s.verts[e[1]][2])/2;
                    totalR+=Math.sqrt(mx*mx+my*my+mz*mz);
                    count++;
                });
                var rho = totalR/count;
                var sg = new THREE.SphereGeometry(rho, 32, 32);
                var sm = new THREE.MeshBasicMaterial({color:0xfbbf24, transparent:true, opacity:0.08, wireframe:true});
                midsphereMesh = new THREE.Mesh(sg, sm);
                group.add(midsphereMesh);
            }

            // Update info
            var dualS = solids.filter(function(x){return x.pq[0]===s.pq[1]&&x.pq[1]===s.pq[0];})[0] || s;
            document.getElementById('iv').textContent = s.V;
            document.getElementById('ie').textContent = s.E;
            document.getElementById('if').textContent = s.F;
            document.getElementById('iv2').textContent = dualS.V;
            document.getElementById('ie2').textContent = dualS.E;
            document.getElementById('if2').textContent = dualS.F;
        }

        window.selectSolid = function(idx){
            currentIdx = idx;
            document.querySelectorAll('.solid-btn').forEach(function(b,i){
                if(i===idx){
                    b.className='solid-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/10 border border-violet-500 text-violet-400';
                } else {
                    b.className='solid-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400';
                }
            });
            rebuild();
        };

        document.getElementById('dual-slider').addEventListener('input', function(){
            dualT = this.value / 100;
            document.getElementById('dual-val').textContent = this.value + '%';
            rebuild();
        });
        document.getElementById('show-mid').addEventListener('change', function(){ rebuild(); });

        // Drag rotation
        var isDragging = false, prevX = 0, prevY = 0, autoTimer = 0;
        canvas.addEventListener('mousedown', function(e){isDragging=true;prevX=e.clientX;prevY=e.clientY;autoTimer=0;});
        canvas.addEventListener('mousemove', function(e){
            if(!isDragging) return;
            var dx=e.clientX-prevX, dy=e.clientY-prevY;
            group.rotation.y+=dx*0.01;
            group.rotation.x+=dy*0.01;
            prevX=e.clientX; prevY=e.clientY;
        });
        canvas.addEventListener('mouseup', function(){isDragging=false;});
        canvas.addEventListener('mouseleave', function(){isDragging=false;});
        // Touch
        canvas.addEventListener('touchstart', function(e){
            e.preventDefault();isDragging=true;prevX=e.touches[0].clientX;prevY=e.touches[0].clientY;autoTimer=0;
        },{passive:false});
        canvas.addEventListener('touchmove', function(e){
            e.preventDefault();
            if(!isDragging) return;
            var dx=e.touches[0].clientX-prevX, dy=e.touches[0].clientY-prevY;
            group.rotation.y+=dx*0.01;
            group.rotation.x+=dy*0.01;
            prevX=e.touches[0].clientX; prevY=e.touches[0].clientY;
        },{passive:false});
        canvas.addEventListener('touchend', function(){isDragging=false;});

        rebuild();

        function animate(){
            requestAnimationFrame(animate);
            if(!isDragging){
                autoTimer += 0.016;
                if(autoTimer > 3) group.rotation.y += 0.003;
            }
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', function(){
            W = canvas.clientWidth; H = canvas.clientHeight;
            camera.aspect = W/H;
            camera.updateProjectionMatrix();
            renderer.setSize(W, H);
        });
    })();
    </script>
</body>
</html>
