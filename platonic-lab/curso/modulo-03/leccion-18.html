<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lección 18: Ejes, Planos y Representaciones | Matemáticas Visuales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glow-text { text-shadow: 0 0 20px rgba(168, 85, 247, 0.5); }
        .progress-bar { background: linear-gradient(90deg, #a855f7, #22d3ee); }
        .katex { color: inherit; font-size: 1.1em; }
    </style>
</head>
<body class="bg-black text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="border-b border-gray-900 bg-black/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <nav class="text-xs text-gray-600 mb-1">
                        <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                        <span class="mx-1">/</span>
                        <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
                        <span class="mx-1">/</span>
                        <span class="text-gray-500">Modulo 03</span>
                    </nav>
                    <h1 class="text-lg font-light">
                        <span class="text-violet-400 font-medium glow-text">Leccion 18</span> — Ejes, Planos y Representaciones
                    </h1>
                </div>
                <nav class="flex gap-2 text-sm">
                    <a href="./leccion-17.html" class="px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 transition">← Anterior</a>
                    <a href="../modulo-04/leccion-19.html" class="px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 transition">Modulo 4 →</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-1">
                <div class="bg-gray-950 border border-gray-900 rounded-2xl p-6 sticky top-24">
                    <h3 class="text-lg font-semibold mb-4 text-cyan-400">Modulo 03</h3>
                    <p class="text-sm text-gray-500 mb-4">Dualidad y Simetria</p>

                    <div class="mb-6">
                        <div class="flex justify-between text-xs text-gray-500 mb-2">
                            <span>Progreso</span>
                            <span>6/6</span>
                        </div>
                        <div class="w-full bg-gray-900 rounded-full h-1.5">
                            <div class="progress-bar h-1.5 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>

                    <div class="mb-4 p-3 bg-emerald-500/5 border border-emerald-500/20 rounded-lg">
                        <p class="text-emerald-400 text-sm font-medium text-center">Modulo completado</p>
                    </div>

                    <nav class="space-y-1 text-sm">
                        <a href="./leccion-13.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-500 transition">13. Concepto de Dualidad</a>
                        <a href="./leccion-14.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-500 transition">14. El Tetraedro Autodual</a>
                        <a href="./leccion-15.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-500 transition">15. Cubo y Octaedro</a>
                        <a href="./leccion-16.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-500 transition">16. Dodecaedro e Icosaedro</a>
                        <a href="./leccion-17.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-500 transition">17. Grupos de Simetria</a>
                        <a href="./leccion-18.html" class="block px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 font-medium">18. Ejes, Planos y Representaciones</a>
                    </nav>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="lg:col-span-3 space-y-8">
                <article class="bg-gray-950 border border-gray-900 rounded-2xl p-8">
                    <!-- Title -->
                    <div class="mb-8">
                        <h2 class="text-3xl font-light mt-2 mb-4">
                            <span class="text-violet-400 glow-text">Ejes, Planos y Representaciones</span>
                        </h2>
                        <p class="text-gray-400 text-lg leading-relaxed">
                            En la Leccion 17 contamos rotaciones. Ahora completamos el cuadro: planos de reflexion, clasificacion de isometrias, clases de conjugacion y una primera mirada a las representaciones. Cerramos el Modulo 3 con el marco completo de simetria poliedral.
                        </p>
                    </div>

                    <!-- Section 1: O(3) and SO(3) -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">El Marco: \(O(3)\) y \(SO(3)\)</h3>

                        <p class="text-gray-300 mb-4">
                            Toda simetria de un poliedro centrado en el origen es una <strong class="text-white">isometria lineal</strong> — una transformacion que preserva distancias y fija el origen. Estas forman el <strong class="text-white">grupo ortogonal</strong>:
                        </p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 mb-6 text-center">
                            $$ O(3) = \{A \in \text{GL}(3, \mathbb{R}) : A^T A = I\} $$
                            <p class="text-gray-400 text-sm mt-3">
                                Toda \(A \in O(3)\) satisface \(\det(A) = \pm 1\).
                            </p>
                        </div>

                        <p class="text-gray-300 mb-4">
                            Las matrices con \(\det = +1\) forman el <strong class="text-white">grupo ortogonal especial</strong> \(SO(3)\) — las <strong class="text-white">rotaciones propias</strong>. Las de \(\det = -1\) son <strong class="text-white">rotaciones impropias</strong>: reflexiones, inversiones y rotorreflexiones.
                        </p>

                        <p class="text-gray-300 mb-4">
                            Los grupos platonicos \(T\), \(O\), \(I\) son subgrupos finitos de \(SO(3)\). Un resultado clasico de la teoria de grupos establece:
                        </p>

                        <div class="bg-violet-500/5 border border-violet-500/20 rounded-xl p-6 mb-4">
                            <p class="text-gray-300">
                                <strong class="text-violet-400">Clasificacion.</strong> Los unicos subgrupos finitos de \(SO(3)\) son: los ciclicos \(C_n\), los diedricos \(D_n\), y los tres grupos poliedricos \(T\), \(O\), \(I\). No hay otros.
                            </p>
                        </div>

                        <p class="text-gray-300">
                            Los grupos completos \(T_d\), \(O_h\), \(I_h\) son subgrupos finitos de \(O(3)\). La relacion entre ambos niveles es: \(O(3) \cong SO(3) \times \{I, -I\}\), pero a nivel de subgrupos finitos, solo el cubo y el icosaedro heredan esta factorizacion directa.
                        </p>
                    </section>

                    <!-- Section 2: Reflection planes -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Planos de Reflexion</h3>

                        <p class="text-gray-300 mb-4">
                            Una reflexion \(\sigma\) a traves de un plano con normal unitaria \(\mathbf{n}\) actua como:
                        </p>
                        $$ \sigma(\mathbf{x}) = \mathbf{x} - 2(\mathbf{x} \cdot \mathbf{n})\,\mathbf{n} $$
                        <p class="text-gray-300 mb-6">
                            con \(\det(\sigma) = -1\) y \(\sigma^2 = e\). Cada plano de reflexion de un poliedro pasa por el centro y contiene al menos un eje de rotacion.
                        </p>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-5">
                                <h4 class="text-emerald-400 font-semibold mb-2">Tetraedro: 6 planos</h4>
                                <p class="text-sm text-gray-400 mb-2">Cada plano contiene una arista y biseca la arista opuesta.</p>
                                <p class="text-sm text-gray-500">3 pares de aristas opuestas &times; 2 planos = 6</p>
                                <p class="text-xs text-gray-600 mt-2 mono">Normales: \((0,1,\pm 1)\), \((1,0,\pm 1)\), \((1,\pm 1,0)\)</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-5">
                                <h4 class="text-emerald-400 font-semibold mb-2">Cubo: 9 planos</h4>
                                <p class="text-sm text-gray-400 mb-2">3 planos coordenados (\(\sigma_h\)) + 6 planos diagonales (\(\sigma_d\)).</p>
                                <p class="text-sm text-gray-500">Los \(\sigma_h\) son perpendiculares a los ejes \(C_4\); los \(\sigma_d\) a los ejes \(C_2\).</p>
                                <p class="text-xs text-gray-600 mt-2 mono">Normales: \((1,0,0)\), ..., \((1,\pm 1,0)\), ...</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-5">
                                <h4 class="text-emerald-400 font-semibold mb-2">Icosaedro: 15 planos</h4>
                                <p class="text-sm text-gray-400 mb-2">Cada plano es perpendicular a un eje \(C_2\) (por aristas).</p>
                                <p class="text-sm text-gray-500">30 aristas / 2 pares opuestos = 15</p>
                                <p class="text-xs text-gray-600 mt-2">Normales: los 15 puntos medios de aristas opuestas</p>
                            </div>
                        </div>

                        <p class="text-gray-300">
                            <strong class="text-white">Patron general.</strong> Para los solidos con simetria de inversion (\(\{4,3\}\) y \(\{5,3\}\)), cada plano de reflexion es perpendicular a un eje \(C_2\) y pasa por el centro: \(\sigma = i \circ C_2\). El numero de planos iguala el numero de ejes \(C_2\) mas los ejes de orden superior que contienen un \(C_2\). Para el tetraedro (sin inversion), cada plano contiene un eje \(C_3\) y un eje \(C_2\) simultaneamente.
                        </p>
                    </section>

                    <!-- Section 3: Improper rotations -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Rotorreflexiones e Inversion</h3>

                        <p class="text-gray-300 mb-4">
                            Las operaciones impropias (\(\det = -1\)) se clasifican en tres tipos:
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Operacion</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Simbolo</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Descripcion</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Orden</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Reflexion</td>
                                        <td class="px-4 py-2 text-center mono">\(\sigma\)</td>
                                        <td class="px-4 py-2 text-gray-400">Espejo a traves de un plano</td>
                                        <td class="px-4 py-2 text-center">2</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Inversion</td>
                                        <td class="px-4 py-2 text-center mono">\(i\)</td>
                                        <td class="px-4 py-2 text-gray-400">\(\mathbf{x} \mapsto -\mathbf{x}\); equivale a \(S_2\)</td>
                                        <td class="px-4 py-2 text-center">2</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Rotorreflexion</td>
                                        <td class="px-4 py-2 text-center mono">\(S_n\)</td>
                                        <td class="px-4 py-2 text-gray-400">Rotacion \(2\pi/n\) seguida de reflexion en plano perpendicular</td>
                                        <td class="px-4 py-2 text-center">\(n\) o \(2n\)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300 mb-4">
                            Toda operacion impropia es una rotorreflexion \(S_n\) para algun \(n\). Los casos especiales son: \(S_1 = \sigma\) (reflexion) y \(S_2 = i\) (inversion). El orden de \(S_n\) como elemento del grupo es \(n\) si \(n\) es par, y \(2n\) si \(n\) es impar.
                        </p>

                        <p class="text-gray-300">
                            <strong class="text-white">Inventario de operaciones impropias:</strong> \(T_d\) contiene \(6\sigma_d + 3S_4 + 3S_4^3 = 12\) impropias. \(O_h\) contiene \(3\sigma_h + 6\sigma_d + i + 6S_4 + 8S_6 = 24\) impropias. \(I_h\) contiene \(15\sigma + i + 12S_{10} + 12S_{10}^3 + 20S_6 = 60\) impropias. En cada caso, las impropias duplican exactamente las rotaciones propias.
                        </p>
                    </section>

                    <!-- Section 4: Conjugacy classes -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Clases de Conjugacion</h3>

                        <p class="text-gray-300 mb-4">
                            Dos elementos \(g, h \in G\) son <strong class="text-white">conjugados</strong> si existe \(k \in G\) tal que \(h = kgk^{-1}\). Geometricamente: \(g\) y \(h\) son conjugados si y solo si son <strong class="text-white">el mismo tipo de operacion</strong> — el mismo angulo de rotacion, pero posiblemente alrededor de ejes distintos (que la simetria del solido hace equivalentes).
                        </p>

                        <p class="text-gray-300 mb-4">
                            Esto explica por que la tabla de conteo de la Leccion 17 se organiza naturalmente por tipos de eje: cada fila corresponde a una o dos clases de conjugacion.
                        </p>

                        <p class="text-gray-300 mb-2"><strong class="text-white">Ejemplo: clases de conjugacion de \(O \cong S_4\).</strong></p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Clase en \(S_4\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Tamano</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Geometria del cubo</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Angulo</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono">\(e\)</td>
                                        <td class="px-4 py-2 text-center">1</td>
                                        <td class="px-4 py-2 text-gray-400">Identidad</td>
                                        <td class="px-4 py-2 text-center mono">0°</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono">\((12)(34)\)</td>
                                        <td class="px-4 py-2 text-center">3</td>
                                        <td class="px-4 py-2 text-gray-400">\(C_4^2\): rotacion 180° por eje de caras</td>
                                        <td class="px-4 py-2 text-center mono">180°</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono">\((123)\)</td>
                                        <td class="px-4 py-2 text-center">8</td>
                                        <td class="px-4 py-2 text-gray-400">\(C_3\): rotacion 120°/240° por diagonal</td>
                                        <td class="px-4 py-2 text-center mono">120°, 240°</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono">\((1234)\)</td>
                                        <td class="px-4 py-2 text-center">6</td>
                                        <td class="px-4 py-2 text-gray-400">\(C_4\): rotacion 90°/270° por eje de caras</td>
                                        <td class="px-4 py-2 text-center mono">90°, 270°</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2 mono">\((12)\)</td>
                                        <td class="px-4 py-2 text-center">6</td>
                                        <td class="px-4 py-2 text-gray-400">\(C_2\): rotacion 180° por eje de aristas</td>
                                        <td class="px-4 py-2 text-center mono">180°</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300">
                            Nota que hay 5 clases de conjugacion — esto coincide con el numero de representaciones irreducibles (Leccion avanzada). Las dimensiones de esas representaciones satisfacen \(1^2 + 1^2 + 2^2 + 3^2 + 3^2 = 24 = |S_4|\).
                        </p>
                    </section>

                    <!-- Section 5: Schoenflies notation -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Notacion de Schoenflies</h3>

                        <p class="text-gray-300 mb-4">
                            La <strong class="text-white">notacion de Schoenflies</strong>, estandar en cristalografia y quimica, clasifica los grupos puntuales de simetria. Los poliedricos son:
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Schoenflies</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Coxeter</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(|G|\)</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Descripcion</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(T\)</td>
                                        <td class="px-4 py-2 mono">[3,3]⁺</td>
                                        <td class="px-4 py-2 text-center">12</td>
                                        <td class="px-4 py-2 text-gray-400">Rotaciones del tetraedro</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(T_d\)</td>
                                        <td class="px-4 py-2 mono">[3,3]</td>
                                        <td class="px-4 py-2 text-center">24</td>
                                        <td class="px-4 py-2 text-gray-400">Tetraedro completo (con \(\sigma_d\))</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(T_h\)</td>
                                        <td class="px-4 py-2 mono">[3⁺,4]</td>
                                        <td class="px-4 py-2 text-center">24</td>
                                        <td class="px-4 py-2 text-gray-400">Piritohedral (T + inversion, sin \(\sigma_d\))</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(O\)</td>
                                        <td class="px-4 py-2 mono">[4,3]⁺</td>
                                        <td class="px-4 py-2 text-center">24</td>
                                        <td class="px-4 py-2 text-gray-400">Rotaciones del cubo/octaedro</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(O_h\)</td>
                                        <td class="px-4 py-2 mono">[4,3]</td>
                                        <td class="px-4 py-2 text-center">48</td>
                                        <td class="px-4 py-2 text-gray-400">Cubo/octaedro completo</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2 mono text-violet-400">\(I\)</td>
                                        <td class="px-4 py-2 mono">[5,3]⁺</td>
                                        <td class="px-4 py-2 text-center">60</td>
                                        <td class="px-4 py-2 text-gray-400">Rotaciones del dodeca/icosaedro</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2 mono text-violet-400">\(I_h\)</td>
                                        <td class="px-4 py-2 mono">[5,3]</td>
                                        <td class="px-4 py-2 text-center">120</td>
                                        <td class="px-4 py-2 text-gray-400">Dodeca/icosaedro completo</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300">
                            La notacion de Coxeter usa el simbolo de Schlafli: \([p,q]^+\) denota el grupo de rotaciones de \(\{p,q\}\), y \([p,q]\) el grupo completo. Asi \([4,3]^+ = O\) y \([4,3] = O_h\). Esta notacion se extiende naturalmente a 4D: \([p,q,r]\) clasifica los politopos regulares de dimension 4.
                        </p>
                    </section>

                    <!-- Section 6: Character tables -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Tablas de Caracteres</h3>

                        <p class="text-gray-300 mb-4">
                            Una <strong class="text-white">representacion</strong> de un grupo \(G\) es un homomorfismo \(\rho: G \to GL(V)\) que asigna a cada simetria una matriz invertible. El <strong class="text-white">caracter</strong> de la representacion es la funcion \(\chi(g) = \text{tr}(\rho(g))\) — la traza de la matriz.
                        </p>

                        <p class="text-gray-300 mb-4">
                            Para la representacion natural (rotaciones actuando en \(\mathbb{R}^3\)), la traza de una rotacion por angulo \(\theta\) es:
                        </p>

                        $$ \chi(\theta) = 1 + 2\cos\theta $$

                        <p class="text-gray-300 mb-6">
                            Esto produce: \(\chi(0°) = 3\), \(\chi(180°) = -1\), \(\chi(120°) = 0\), \(\chi(90°) = 1\), \(\chi(72°) = \varphi\), \(\chi(144°) = 1-\varphi\). La proporcion aurea emerge directamente de \(\cos 72°\).
                        </p>

                        <p class="text-gray-300 mb-2"><strong class="text-white">Tabla de caracteres de \(A_4\)</strong> (tetraedro):</p>
                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">\(A_4\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(e\) (1)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((12)(34)\) (3)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((123)\) (4)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((132)\) (4)</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">A</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td></tr>
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">E</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">\(\omega\)</td><td class="px-4 py-2 text-center">\(\omega^2\)</td></tr>
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">E'</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">\(\omega^2\)</td><td class="px-4 py-2 text-center">\(\omega\)</td></tr>
                                    <tr><td class="px-4 py-2 mono text-violet-400">T</td><td class="px-4 py-2 text-center">3</td><td class="px-4 py-2 text-center">-1</td><td class="px-4 py-2 text-center">0</td><td class="px-4 py-2 text-center">0</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-gray-500 text-sm mb-6">\(\omega = e^{2\pi i/3}\). La representacion \(T\) (dimension 3) es la accion natural sobre \(\mathbb{R}^3\). Verificacion: \(1^2 + 1^2 + 1^2 + 3^2 = 12 = |A_4|\).</p>

                        <p class="text-gray-300 mb-2"><strong class="text-white">Tabla de caracteres de \(A_5\)</strong> (icosaedro):</p>
                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">\(A_5\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(e\) (1)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((12)(34)\) (15)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((123)\) (20)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((12345)\) (12)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\((12354)\) (12)</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">A</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">1</td></tr>
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">\(T_1\)</td><td class="px-4 py-2 text-center">3</td><td class="px-4 py-2 text-center">-1</td><td class="px-4 py-2 text-center">0</td><td class="px-4 py-2 text-center">\(\varphi\)</td><td class="px-4 py-2 text-center">\(1-\varphi\)</td></tr>
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">\(T_2\)</td><td class="px-4 py-2 text-center">3</td><td class="px-4 py-2 text-center">-1</td><td class="px-4 py-2 text-center">0</td><td class="px-4 py-2 text-center">\(1-\varphi\)</td><td class="px-4 py-2 text-center">\(\varphi\)</td></tr>
                                    <tr class="border-b border-gray-900"><td class="px-4 py-2 mono text-violet-400">G</td><td class="px-4 py-2 text-center">4</td><td class="px-4 py-2 text-center">0</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">-1</td><td class="px-4 py-2 text-center">-1</td></tr>
                                    <tr><td class="px-4 py-2 mono text-violet-400">H</td><td class="px-4 py-2 text-center">5</td><td class="px-4 py-2 text-center">1</td><td class="px-4 py-2 text-center">-1</td><td class="px-4 py-2 text-center">0</td><td class="px-4 py-2 text-center">0</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="bg-violet-500/5 border border-violet-500/20 rounded-xl p-6 mb-4">
                            <p class="text-gray-300">
                                <strong class="text-violet-400">\(\varphi\) en la tabla de \(A_5\).</strong> El caracter de \(T_1\) en la clase de los 5-ciclos es \(\chi(72°) = 1 + 2\cos 72° = 1 + 2 \cdot \frac{\sqrt{5}-1}{4} = \frac{1+\sqrt{5}}{2} = \varphi\). La proporcion aurea no es una decoracion: emerge de la traza de la rotacion de 72° en la representacion tridimensional. Geometria, algebra y teoria de numeros se encuentran en esta unica entrada de la tabla.
                            </p>
                        </div>

                        <p class="text-gray-300">
                            Verificacion: \(1^2 + 3^2 + 3^2 + 4^2 + 5^2 = 1 + 9 + 9 + 16 + 25 = 60 = |A_5|\). Las 5 representaciones irreducibles, con dimensiones 1, 3, 3, 4, 5, capturan toda la estructura algebraica del icosaedro.
                        </p>
                    </section>

                    <!-- Section 7: Beyond Platonic -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Mas Alla de los Platonicos: Solidos de Arquimedes</h3>

                        <p class="text-gray-300 mb-4">
                            Los <strong class="text-white">solidos de Arquimedes</strong> son poliedros convexos con caras regulares de dos o mas tipos, y vertices todos equivalentes bajo simetrias (<strong class="text-white">transitivos por vertices</strong>). Hay exactamente 13, y heredan los grupos de simetria de los platonicos de los que derivan.
                        </p>

                        <p class="text-gray-300 mb-4">
                            Ya encontramos dos en este modulo: el <strong class="text-white">cuboctaedro</strong> \((3.4.3.4)\) en la Leccion 15 (rectificacion del cubo, grupo \(O_h\)) y el <strong class="text-white">icosidodecaedro</strong> \((3.5.3.5)\) en la Leccion 16 (rectificacion del dodecaedro, grupo \(I_h\)).
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm border border-gray-800 rounded-lg overflow-hidden">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Operacion</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Ejemplo</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Config. vertice</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Grupo</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300">
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Truncar</td>
                                        <td class="px-4 py-2 text-gray-400">Icosaedro truncado (balon de futbol)</td>
                                        <td class="px-4 py-2 text-center mono">5.6.6</td>
                                        <td class="px-4 py-2 text-center mono">\(I_h\)</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Rectificar</td>
                                        <td class="px-4 py-2 text-gray-400">Cuboctaedro</td>
                                        <td class="px-4 py-2 text-center mono">3.4.3.4</td>
                                        <td class="px-4 py-2 text-center mono">\(O_h\)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Snub</td>
                                        <td class="px-4 py-2 text-gray-400">Snub cube (quiral)</td>
                                        <td class="px-4 py-2 text-center mono">3.3.3.3.4</td>
                                        <td class="px-4 py-2 text-center mono">\(O\) (no \(O_h\))</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300">
                            Los solidos <strong class="text-white">snub</strong> (snub cube y snub dodecahedron) son <strong class="text-white">quirales</strong>: no son congruentes con su imagen especular. Su grupo de simetria es solo el de rotaciones (\(O\) o \(I\)), sin reflexiones. Son los unicos poliedros de Arquimedes que distinguen izquierda de derecha.
                        </p>
                    </section>

                    <!-- Section 8: Module recap -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">Recapitulacion del Modulo 3</h3>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6">
                            <div class="space-y-4">
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L13.</span>
                                    <p class="text-gray-300"><strong class="text-white">Concepto de dualidad.</strong> Operador \(^*\): \(V \leftrightarrow F\), \(E = E\), \(\{p,q\}^* = \{q,p\}\). Teorema \(\text{Sym}(P) = \text{Sym}(P^*)\).</p>
                                </div>
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L14.</span>
                                    <p class="text-gray-300"><strong class="text-white">Tetraedro autodual.</strong> \(T^* = -T/3\), stella octangula, \(K_4\), \(T \cong A_4\) (12), \(T_d \cong S_4\) (24).</p>
                                </div>
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L15.</span>
                                    <p class="text-gray-300"><strong class="text-white">Cubo y octaedro.</strong> Aristas perpendiculares, midsphere compartida, cuboctaedro, \(O \cong S_4\) (24), \(O_h\) (48).</p>
                                </div>
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L16.</span>
                                    <p class="text-gray-300"><strong class="text-white">Dodecaedro e icosaedro.</strong> Coordenadas con \(\varphi\), rectangulos aureos, 5 cubos inscritos, icosidodecaedro, \(I \cong A_5\) (60), \(I_h\) (120).</p>
                                </div>
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L17.</span>
                                    <p class="text-gray-300"><strong class="text-white">Grupos de simetria.</strong> Axiomas, conteo sistematico de ejes, isomorfismos \(T \cong A_4\), \(O \cong S_4\), \(I \cong A_5\), orbita-estabilizador.</p>
                                </div>
                                <div class="flex gap-3">
                                    <span class="text-violet-400 font-semibold shrink-0">L18.</span>
                                    <p class="text-gray-300"><strong class="text-white">Ejes, planos y representaciones.</strong> \(O(3)/SO(3)\), planos de reflexion, rotorreflexiones, clases de conjugacion, Schoenflies, tablas de caracteres, Arquimedes.</p>
                                </div>
                            </div>

                            <div class="mt-6 pt-4 border-t border-gray-800">
                                <p class="text-gray-400 text-sm">
                                    <strong class="text-white">Hilo conductor:</strong> la dualidad geometrica de las lecciones 13-16 revelo que los cinco solidos se organizan en tres familias de simetria. Las lecciones 17-18 develaron la estructura algebraica de esas familias: tres grupos (\(A_4\), \(S_4\), \(A_5\)) que agotan las simetrias discretas del espacio tridimensional.
                                </p>
                            </div>
                        </div>
                    </section>

                    <!-- Exercises -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">Ejercicios</h3>
                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4">
                            <div>
                                <p class="text-gray-300"><strong class="text-white">1.</strong> Encuentra todos los subgrupos de \(A_4\). Demuestra que \(A_4\) no tiene subgrupo de orden 6, a pesar de que \(6 \mid 12\). ¿Que dice esto sobre el reciproco del teorema de Lagrange?</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">2.</strong> El centro de un grupo es \(Z(G) = \{g \in G : gh = hg\;\forall h\}\). Calcula \(Z(T)\), \(Z(O)\) y \(Z(I)\). ¿Que interpretacion geometrica tiene que los tres centros sean triviales?</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">3.</strong> Verifica que \(\chi(72°) = 1 + 2\cos 72° = \varphi\). Luego calcula \(\chi(144°)\) y verifica que da \(1 - \varphi\). ¿Cual es la relacion entre las dos clases de 5-ciclos de \(A_5\)?</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">4.</strong> El snub cube tiene grupo de rotaciones \(O\) (24) pero grupo completo tambien \(O\) (24, no \(O_h\)). Explica geometricamente por que las reflexiones no son simetrias del snub cube.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">5.</strong> Para el cubo, verifica que los 9 planos de reflexion se descomponen en 3 planos perpendiculares a ejes \(C_4\) y 6 planos perpendiculares a ejes \(C_2\). Muestra que ningun plano es perpendicular a un eje \(C_3\).</p>
                            </div>
                        </div>
                    </section>

                    <!-- LAB -->
                    <section>
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">LAB: Planos de Reflexion</h3>
                        <p class="text-gray-400 mb-4">
                            Visualiza los planos de reflexion (discos translucidos verdes) y los ejes de rotacion de cada solido. Arrastra para rotar.
                        </p>

                        <div class="flex flex-wrap gap-2 mb-4">
                            <button onclick="switchSolid('tetrahedron')" id="btn-tetra" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-800 text-gray-400 hover:bg-gray-700 transition">Tetraedro</button>
                            <button onclick="switchSolid('cube')" id="btn-cube" class="px-4 py-2 rounded-lg text-sm font-medium bg-violet-500/20 text-violet-400 transition">Cubo</button>
                            <button onclick="switchSolid('icosahedron')" id="btn-ico" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-800 text-gray-400 hover:bg-gray-700 transition">Icosaedro</button>
                            <span class="border-l border-gray-800 mx-2"></span>
                            <button onclick="toggleLayer('planes')" id="btn-planes" class="px-3 py-2 rounded-lg text-sm font-medium bg-emerald-500/20 text-emerald-400 transition">Planos</button>
                            <button onclick="toggleLayer('axes')" id="btn-axes" class="px-3 py-2 rounded-lg text-sm font-medium bg-violet-500/20 text-violet-400 transition">Ejes</button>
                        </div>

                        <div id="lab-info" class="text-sm text-gray-500 mb-3 mono"></div>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden" style="height: 480px;">
                            <canvas id="labCanvas"></canvas>
                        </div>
                    </section>
                </article>

                <!-- Navigation -->
                <div class="flex justify-between items-center">
                    <a href="./leccion-17.html" class="px-6 py-3 bg-gray-900 border border-gray-800 rounded-xl text-gray-400 hover:text-white hover:border-gray-700 transition">← Grupos de Simetria</a>
                    <a href="../modulo-04/leccion-19.html" class="px-6 py-3 bg-violet-500/10 border border-violet-500/20 rounded-xl text-violet-400 hover:bg-violet-500/20 transition">Modulo 4: La Cuarta Dimension →</a>
                </div>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-gray-900 mt-16">
        <div class="max-w-6xl mx-auto px-6 py-8">
            <p class="text-center text-gray-700 text-sm">&copy; 2025 EigenLab — Matematicas Visuales</p>
        </div>
    </footer>

    <!-- Three.js -->
    <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
    <script>
    (function(){
        const canvas = document.getElementById('labCanvas');
        const container = canvas.parentElement;
        const W = container.clientWidth, H = container.clientHeight;
        canvas.width = W * devicePixelRatio;
        canvas.height = H * devicePixelRatio;
        canvas.style.width = W + 'px';
        canvas.style.height = H + 'px';

        const renderer = new THREE.WebGLRenderer({canvas, antialias: true, alpha: true});
        renderer.setSize(W, H);
        renderer.setPixelRatio(devicePixelRatio);

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(45, W/H, 0.1, 100);
        camera.position.set(0, 0, 6);

        const group = new THREE.Group();
        scene.add(group);

        // Materials
        const meshMat = new THREE.MeshBasicMaterial({color: 0x7c3aed, transparent: true, opacity: 0.06, side: THREE.DoubleSide});
        const wireMat = new THREE.LineBasicMaterial({color: 0x6d28d9, transparent: true, opacity: 0.5});
        const pointMat = new THREE.PointsMaterial({color: 0xa78bfa, size: 4, sizeAttenuation: false});
        const planeMat = new THREE.MeshBasicMaterial({color: 0x10b981, transparent: true, opacity: 0.10, side: THREE.DoubleSide});
        const planeEdgeMat = new THREE.LineBasicMaterial({color: 0x10b981, transparent: true, opacity: 0.25});

        const axisColors = { high: 0xa78bfa, mid: 0x22d3ee, low: 0xfbbf24 };

        const phi = (1 + Math.sqrt(5)) / 2;

        // ======= Geometry helpers =======
        function dist(a, b) {
            return Math.sqrt((a[0]-b[0])**2 + (a[1]-b[1])**2 + (a[2]-b[2])**2);
        }

        function buildEdges(verts, threshold) {
            const edges = [];
            for (let i = 0; i < verts.length; i++)
                for (let j = i+1; j < verts.length; j++)
                    if (Math.abs(dist(verts[i], verts[j]) - threshold) < 0.01)
                        edges.push([i, j]);
            return edges;
        }

        function antipodePairs(dirs) {
            const pairs = [];
            const used = new Set();
            for (let i = 0; i < dirs.length; i++) {
                if (used.has(i)) continue;
                let found = false;
                for (let j = i+1; j < dirs.length; j++) {
                    if (used.has(j)) continue;
                    if (Math.abs(dirs[i][0]+dirs[j][0]) < 0.05 &&
                        Math.abs(dirs[i][1]+dirs[j][1]) < 0.05 &&
                        Math.abs(dirs[i][2]+dirs[j][2]) < 0.05) {
                        pairs.push(dirs[i]);
                        used.add(i); used.add(j);
                        found = true; break;
                    }
                }
                if (!found) { pairs.push(dirs[i]); used.add(i); }
            }
            return pairs;
        }

        // Solid vertex data
        const tetraVerts = [[1,1,1],[1,-1,-1],[-1,1,-1],[-1,-1,1]];
        const cubeVerts = [];
        for (let x of [-1,1]) for (let y of [-1,1]) for (let z of [-1,1]) cubeVerts.push([x,y,z]);
        const icoVerts = [
            [0,1,phi],[0,-1,phi],[0,1,-phi],[0,-1,-phi],
            [1,phi,0],[-1,phi,0],[1,-phi,0],[-1,-phi,0],
            [phi,0,1],[-phi,0,1],[phi,0,-1],[-phi,0,-1]
        ];

        // Precompute icosahedron topology
        const icoEdgesList = buildEdges(icoVerts, 2);
        const icoAdj = Array.from({length: 12}, () => new Set());
        for (const [i,j] of icoEdgesList) { icoAdj[i].add(j); icoAdj[j].add(i); }
        const icoFacesList = [];
        for (let i = 0; i < 12; i++)
            for (const j of icoAdj[i]) if (j > i)
                for (const k of icoAdj[j]) if (k > j && icoAdj[i].has(k))
                    icoFacesList.push([i,j,k]);
        const icoFaceCenters = icoFacesList.map(([a,b,c]) => [
            (icoVerts[a][0]+icoVerts[b][0]+icoVerts[c][0])/3,
            (icoVerts[a][1]+icoVerts[b][1]+icoVerts[c][1])/3,
            (icoVerts[a][2]+icoVerts[b][2]+icoVerts[c][2])/3
        ]);
        const icoEdgeMids = icoEdgesList.map(([a,b]) => [
            (icoVerts[a][0]+icoVerts[b][0])/2,
            (icoVerts[a][1]+icoVerts[b][1])/2,
            (icoVerts[a][2]+icoVerts[b][2])/2
        ]);

        // ======= Axes and planes data =======
        function getSolidData(type) {
            const s2 = Math.sqrt(2);
            switch(type) {
                case 'tetrahedron': return {
                    verts: tetraVerts, edgeDist: 2*s2,
                    axes: {
                        high: {dirs:[[1,1,1],[1,-1,-1],[-1,1,-1],[-1,-1,1]], order:3, color:axisColors.high},
                        mid: null,
                        low: {dirs:[[1,0,0],[0,1,0],[0,0,1]], order:2, color:axisColors.low}
                    },
                    planeNormals: [[0,1,-1],[0,1,1],[1,0,-1],[1,0,1],[1,-1,0],[1,1,0]],
                    info: 'Td ≅ S₄  |  7 ejes (4 C₃ + 3 C₂) + 6 planos  |  |Td| = 24'
                };
                case 'cube': return {
                    verts: cubeVerts, edgeDist: 2,
                    axes: {
                        high: {dirs:[[1,0,0],[0,1,0],[0,0,1]], order:4, color:axisColors.high},
                        mid: {dirs:[[1,1,1],[1,1,-1],[1,-1,1],[-1,1,1]], order:3, color:axisColors.mid},
                        low: {dirs:[[1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]], order:2, color:axisColors.low}
                    },
                    planeNormals: [
                        [1,0,0],[0,1,0],[0,0,1],
                        [1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]
                    ],
                    info: 'Oh ≅ S₄×Z₂  |  13 ejes (3 C₄ + 4 C₃ + 6 C₂) + 9 planos  |  |Oh| = 48'
                };
                case 'icosahedron': return {
                    verts: icoVerts, edgeDist: 2,
                    axes: {
                        high: {dirs: antipodePairs(icoVerts.map(v=>v.slice())), order:5, color:axisColors.high},
                        mid: {dirs: antipodePairs(icoFaceCenters), order:3, color:axisColors.mid},
                        low: {dirs: antipodePairs(icoEdgeMids), order:2, color:axisColors.low}
                    },
                    planeNormals: antipodePairs(icoEdgeMids),
                    info: 'Ih ≅ A₅×Z₂  |  31 ejes (6 C₅ + 10 C₃ + 15 C₂) + 15 planos  |  |Ih| = 120'
                };
            }
        }

        // ======= Build 3D objects =======
        let solidObjects = [];
        let axisObjects = [];
        let planeObjects = [];
        let showPlanes = true, showAxesFlag = true;
        let currentSolid = 'cube';

        function clearAll() {
            for (const obj of [...solidObjects, ...axisObjects, ...planeObjects]) group.remove(obj);
            solidObjects = []; axisObjects = []; planeObjects = [];
        }

        function createSolidMesh(verts, edgeDist) {
            const edges = buildEdges(verts, edgeDist);
            const edgePos = [];
            for (const [i,j] of edges) {
                edgePos.push(verts[i][0],verts[i][1],verts[i][2]);
                edgePos.push(verts[j][0],verts[j][1],verts[j][2]);
            }
            const eg = new THREE.BufferGeometry();
            eg.setAttribute('position', new THREE.Float32BufferAttribute(edgePos, 3));
            const lines = new THREE.LineSegments(eg, wireMat);

            const ptPos = [];
            for (const v of verts) ptPos.push(v[0],v[1],v[2]);
            const pg = new THREE.BufferGeometry();
            pg.setAttribute('position', new THREE.Float32BufferAttribute(ptPos, 3));
            const points = new THREE.Points(pg, pointMat);

            let bg;
            if (verts.length === 4) bg = new THREE.TetrahedronGeometry(Math.sqrt(3));
            else if (verts.length === 8) bg = new THREE.BoxGeometry(2, 2, 2);
            else bg = new THREE.IcosahedronGeometry(Math.sqrt(1 + phi*phi));
            const mesh = new THREE.Mesh(bg, meshMat);

            return [lines, points, mesh];
        }

        function createAxisLine(dir, color, len) {
            const n = Math.sqrt(dir[0]**2 + dir[1]**2 + dir[2]**2);
            const d = [dir[0]/n, dir[1]/n, dir[2]/n];
            const pos = [-d[0]*len,-d[1]*len,-d[2]*len, d[0]*len,d[1]*len,d[2]*len];
            const g = new THREE.BufferGeometry();
            g.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
            return new THREE.LineSegments(g, new THREE.LineBasicMaterial({color, transparent:true, opacity:0.6}));
        }

        function createPlaneDisc(normal, radius) {
            const discGeo = new THREE.CircleGeometry(radius, 48);
            const disc = new THREE.Mesh(discGeo, planeMat.clone());

            // Edge ring
            const ringGeo = new THREE.RingGeometry(radius - 0.01, radius, 48);
            const ring = new THREE.Mesh(ringGeo, planeEdgeMat.clone());

            const grp = new THREE.Group();
            grp.add(disc);
            grp.add(ring);

            // Orient: align default normal (0,0,1) to target normal
            const nLen = Math.sqrt(normal[0]**2 + normal[1]**2 + normal[2]**2);
            const nDir = new THREE.Vector3(normal[0]/nLen, normal[1]/nLen, normal[2]/nLen);
            const defaultN = new THREE.Vector3(0, 0, 1);
            grp.quaternion.setFromUnitVectors(defaultN, nDir);

            return grp;
        }

        function buildScene(type) {
            clearAll();
            const data = getSolidData(type);

            // Solid mesh
            const meshObjs = createSolidMesh(data.verts, data.edgeDist);
            for (const o of meshObjs) { group.add(o); solidObjects.push(o); }

            // Axes
            const axLen = type === 'icosahedron' ? 2.8 : 2.5;
            for (const key of ['high','mid','low']) {
                if (!data.axes[key]) continue;
                for (const dir of data.axes[key].dirs) {
                    const line = createAxisLine(dir, data.axes[key].color, axLen);
                    line.visible = showAxesFlag;
                    group.add(line);
                    axisObjects.push(line);
                }
            }

            // Planes
            const planeRadius = type === 'icosahedron' ? 2.2 : 2.0;
            for (const normal of data.planeNormals) {
                const disc = createPlaneDisc(normal, planeRadius);
                disc.visible = showPlanes;
                group.add(disc);
                planeObjects.push(disc);
            }

            document.getElementById('lab-info').textContent = data.info;
        }

        // ======= Controls =======
        window.switchSolid = function(type) {
            currentSolid = type;
            buildScene(type);
            const ids = {tetrahedron:'btn-tetra', cube:'btn-cube', icosahedron:'btn-ico'};
            for (const [t, id] of Object.entries(ids)) {
                const btn = document.getElementById(id);
                btn.className = t === type
                    ? 'px-4 py-2 rounded-lg text-sm font-medium bg-violet-500/20 text-violet-400 transition'
                    : 'px-4 py-2 rounded-lg text-sm font-medium bg-gray-800 text-gray-400 hover:bg-gray-700 transition';
            }
        };

        window.toggleLayer = function(layer) {
            if (layer === 'planes') {
                showPlanes = !showPlanes;
                for (const o of planeObjects) o.visible = showPlanes;
                const btn = document.getElementById('btn-planes');
                btn.className = showPlanes
                    ? 'px-3 py-2 rounded-lg text-sm font-medium bg-emerald-500/20 text-emerald-400 transition'
                    : 'px-3 py-2 rounded-lg text-sm font-medium bg-gray-800 text-gray-500 transition';
            } else {
                showAxesFlag = !showAxesFlag;
                for (const o of axisObjects) o.visible = showAxesFlag;
                const btn = document.getElementById('btn-axes');
                btn.className = showAxesFlag
                    ? 'px-3 py-2 rounded-lg text-sm font-medium bg-violet-500/20 text-violet-400 transition'
                    : 'px-3 py-2 rounded-lg text-sm font-medium bg-gray-800 text-gray-500 transition';
            }
        };

        // Drag to rotate
        let isDragging = false, prevMouse = {x:0, y:0};
        let autoRotate = true, lastInteraction = 0;

        canvas.addEventListener('pointerdown', e => {
            isDragging = true;
            prevMouse = {x: e.clientX, y: e.clientY};
            autoRotate = false;
            lastInteraction = performance.now();
        });
        window.addEventListener('pointermove', e => {
            if (!isDragging) return;
            const dx = e.clientX - prevMouse.x;
            const dy = e.clientY - prevMouse.y;
            group.rotation.y += dx * 0.008;
            group.rotation.x += dy * 0.008;
            prevMouse = {x: e.clientX, y: e.clientY};
        });
        window.addEventListener('pointerup', () => {
            isDragging = false;
            lastInteraction = performance.now();
        });

        // Render loop
        function animate() {
            requestAnimationFrame(animate);
            if (!isDragging && performance.now() - lastInteraction > 3000) autoRotate = true;
            if (autoRotate) group.rotation.y += 0.003;
            renderer.render(scene, camera);
        }

        // Init
        group.rotation.x = 0.4;
        group.rotation.y = 0.6;
        buildScene('cube');
        animate();

        // Resize
        window.addEventListener('resize', () => {
            const w = container.clientWidth, h = container.clientHeight;
            canvas.width = w * devicePixelRatio;
            canvas.height = h * devicePixelRatio;
            canvas.style.width = w + 'px';
            canvas.style.height = h + 'px';
            renderer.setSize(w, h);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        });
    })();
    </script>
</body>
</html>
