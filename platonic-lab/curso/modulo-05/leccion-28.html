<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leccion 28: Recorridos — Euler y Hamilton | Matematicas Visuales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glow-text { text-shadow: 0 0 20px rgba(168, 85, 247, 0.5); }
        .progress-bar { background: linear-gradient(90deg, #a855f7, #22d3ee); }
        .katex { color: inherit; font-size: 1.1em; }
    </style>
</head>
<body class="bg-black text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="border-b border-gray-900 bg-black/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <nav class="text-xs text-gray-600 mb-1">
                        <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                        <span class="mx-1">/</span>
                        <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
                        <span class="mx-1">/</span>
                        <span class="text-gray-500">Modulo 05</span>
                    </nav>
                    <h1 class="text-lg font-light">
                        <span class="text-violet-400 font-medium glow-text">Leccion 28</span> — Recorridos: Euler y Hamilton
                    </h1>
                </div>
                <nav class="flex gap-2 text-sm">
                    <a href="./leccion-27.html" class="px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 transition">&larr; Anterior</a>
                    <a href="./leccion-29.html" class="px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 transition">Siguiente &rarr;</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-1">
                <div class="bg-gray-950 border border-gray-900 rounded-2xl p-6 sticky top-24">
                    <h3 class="text-lg font-semibold mb-4 text-cyan-400">Modulo 05</h3>
                    <p class="text-sm text-gray-500 mb-4">Teoria de Grafos</p>

                    <div class="mb-6">
                        <div class="flex justify-between text-xs text-gray-400 mb-2">
                            <span>Progreso</span>
                            <span>4/5</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-2">
                            <div class="progress-bar h-2 rounded-full" style="width: 80%"></div>
                        </div>
                    </div>

                    <nav class="space-y-2">
                        <a href="./leccion-25.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">25. De Poliedros a Grafos</a>
                        <a href="./leccion-26.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">26. Grafos Planares y Steinitz</a>
                        <a href="./leccion-27.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">27. Coloracion de Grafos</a>
                        <a href="./leccion-28.html" class="block px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 text-sm">28. Recorridos: Euler y Hamilton</a>
                        <a href="./leccion-29.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">29. Espectros, Arboles y Sintesis</a>
                    </nav>
                </div>
            </aside>

            <!-- Content -->
            <main class="lg:col-span-3">
                <article class="bg-gray-950 border border-gray-900 rounded-2xl p-8">
                    <div class="mb-8">
                        <span class="text-cyan-400 text-sm font-medium">Leccion 28</span>
                        <h2 class="text-3xl font-light mt-2 mb-4">
                            <span class="text-violet-400 font-medium glow-text">Recorridos:</span> Euler y Hamilton
                        </h2>
                        <p class="text-gray-400 text-lg">Recorrer aristas es polinomial, recorrer vertices es NP-completo. Los cinco solidos como banco de pruebas.</p>
                    </div>

                    <!-- 1. Los Puentes de Konigsberg -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">1. Los Puentes de Konigsberg (1736)</h3>
                        <p class="text-gray-300 mb-4">
                            El primer teorema de la teoria de grafos nacio de un problema recreativo. La ciudad de Konigsberg (hoy Kaliningrado) estaba dividida por el rio Pregel en cuatro zonas de tierra conectadas por siete puentes. Los habitantes se preguntaban: <strong class="text-white">es posible pasear cruzando cada puente exactamente una vez y regresar al punto de partida?</strong>
                        </p>
                        <p class="text-gray-300 mb-4">
                            En 1736, Leonhard Euler abstrajo el problema: reemplazo las zonas de tierra por <strong class="text-white">vertices</strong> y los puentes por <strong class="text-white">aristas</strong>, creando un multigrafo con 4 vertices y 7 aristas. Euler demostro que el paseo era imposible porque mas de dos vertices tenian grado impar. Este argumento fundo la teoria de grafos como disciplina matematica.
                        </p>
                        <p class="text-gray-300">
                            La idea clave de Euler fue que la geometria exacta del problema era irrelevante: solo importaba la <strong class="text-white">estructura de conexiones</strong>. No interesaba la longitud de los puentes ni la forma de las islas, sino unicamente que vertices estaban conectados. Esta abstraccion es el corazon de la teoria de grafos.
                        </p>
                    </section>

                    <!-- 2. Circuitos Eulerianos -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">2. Circuitos Eulerianos</h3>
                        <p class="text-gray-300 mb-4">
                            Un <strong class="text-white">circuito euleriano</strong> en un grafo conexo es un recorrido cerrado que atraviesa cada <strong class="text-white">arista</strong> exactamente una vez. Un <strong class="text-white">camino euleriano</strong> (no cerrado) atraviesa cada arista exactamente una vez pero puede empezar y terminar en vertices distintos.
                        </p>
                        <p class="text-gray-300 mb-4">
                            El teorema de Euler proporciona una caracterizacion completa:
                        </p>

                        $$ \text{G tiene circuito euleriano} \iff \forall v \in V: \deg(v) \equiv 0 \pmod{2} $$

                        <p class="text-gray-300 mb-4">
                            Es decir, un grafo conexo admite un circuito euleriano si y solo si <strong class="text-white">todos sus vertices tienen grado par</strong>. Para un camino euleriano (sin retorno al inicio), la condicion es que exactamente 0 o 2 vertices tengan grado impar.
                        </p>
                        <p class="text-gray-300 mb-4">
                            Apliquemos este criterio a los cinco grafos platonicos. Cada solido platonico es \(q\)-regular, asi que basta verificar la paridad de \(q\):
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Solido</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Grado \(q\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Paridad</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Euleriano?</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center">impar</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center">impar</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 text-center">par</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center">impar</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">5</td>
                                        <td class="px-4 py-2 text-center">impar</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300 mb-4">
                            El octaedro es el <strong class="text-white">unico grafo platonico euleriano</strong>. Con 6 vertices de grado 4 y 12 aristas, admite un circuito que recorre las 12 aristas sin repetir ninguna. Un circuito euleriano explicito es:
                        </p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 mb-4">
                            <p class="text-gray-300 mono text-sm">
                                0 &rarr; 1 &rarr; 2 &rarr; 3 &rarr; 4 &rarr; 1 &rarr; 5 &rarr; 3 &rarr; 0 &rarr; 4 &rarr; 5 &rarr; 2 &rarr; 0
                            </p>
                            <p class="text-gray-500 text-sm mt-2">12 aristas recorridas, regreso al vertice inicial. Cada arista usada exactamente una vez.</p>
                        </div>

                        <!-- Canvas: Euler Circuit of Octahedron -->
                        <div class="my-6">
                            <canvas id="euler-circuit-canvas" class="w-full rounded-xl" style="height: 320px;"></canvas>
                            <p class="text-center text-gray-500 text-sm mt-2">Circuito euleriano del octaedro: las 12 aristas numeradas en orden de recorrido</p>
                        </div>
                    </section>

                    <!-- 3. Hamilton y el Icosian Game -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">3. Hamilton y el Icosian Game</h3>
                        <p class="text-gray-300 mb-4">
                            En 1857, William Rowan Hamilton invento el <strong class="text-white">Icosian Game</strong>, un rompecabezas comercial basado en el grafo del dodecaedro. El desafio consistia en encontrar un ciclo que visitara cada uno de los 20 vertices exactamente una vez, recorriendo aristas del dodecaedro, y regresara al punto de partida.
                        </p>
                        <p class="text-gray-300 mb-4">
                            Un <strong class="text-white">ciclo hamiltoniano</strong> en un grafo \(G\) es un ciclo que visita cada <strong class="text-white">vertice</strong> exactamente una vez y regresa al vertice inicial. Un <strong class="text-white">camino hamiltoniano</strong> visita cada vertice exactamente una vez sin necesidad de regresar. La diferencia con los recorridos eulerianos es fundamental: Euler recorre <strong class="text-white">aristas</strong>, Hamilton recorre <strong class="text-white">vertices</strong>.
                        </p>
                        <p class="text-gray-300">
                            A diferencia del teorema de Euler, que da una condicion necesaria y suficiente elegante, <strong class="text-white">no existe una caracterizacion simple</strong> de los grafos hamiltonianos. No hay un criterio basado unicamente en los grados de los vertices que determine si un grafo tiene un ciclo hamiltoniano. Esta asimetria entre los problemas euleriano y hamiltoniano es una de las mas notables en matematicas discretas.
                        </p>
                    </section>

                    <!-- 4. Los Cinco Platonicos son Hamiltonianos -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">4. Los Cinco Platonicos son Hamiltonianos</h3>
                        <p class="text-gray-300 mb-4">
                            Los cinco solidos platonicos admiten ciclos hamiltonianos. A continuacion exhibimos un ciclo explicito para cada uno, verificando que cada arista consecutiva existe en el grafo y que todos los vertices son visitados exactamente una vez.
                        </p>

                        <div class="space-y-4 mb-6">
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
                                <p class="text-cyan-400 font-medium mb-1">Tetraedro (4 vertices, \(K_4\))</p>
                                <p class="text-gray-300 mono text-sm">0 &rarr; 1 &rarr; 2 &rarr; 3 &rarr; 0</p>
                                <p class="text-gray-500 text-sm mt-1">Trivial: en \(K_4\) toda permutacion de vertices forma un ciclo hamiltoniano.</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
                                <p class="text-cyan-400 font-medium mb-1">Cubo (8 vertices, \(Q_3\))</p>
                                <p class="text-gray-300 mono text-sm">0 &rarr; 1 &rarr; 3 &rarr; 2 &rarr; 6 &rarr; 7 &rarr; 5 &rarr; 4 &rarr; 0</p>
                                <p class="text-gray-500 text-sm mt-1">Codigo Gray de 3 bits: cada paso cambia exactamente un bit.</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
                                <p class="text-cyan-400 font-medium mb-1">Octaedro (6 vertices, \(K_{2,2,2}\))</p>
                                <p class="text-gray-300 mono text-sm">0 &rarr; 1 &rarr; 5 &rarr; 4 &rarr; 3 &rarr; 2 &rarr; 0</p>
                                <p class="text-gray-500 text-sm mt-1">Evita los tres pares antipodales \(\{0,5\}, \{1,3\}, \{2,4\}\).</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
                                <p class="text-cyan-400 font-medium mb-1">Dodecaedro (20 vertices)</p>
                                <p class="text-gray-300 mono text-sm">0 &rarr; 1 &rarr; 6 &rarr; 10 &rarr; 5 &rarr; 14 &rarr; 19 &rarr; 15 &rarr; 16 &rarr; 11 &rarr; 7 &rarr; 2 &rarr; 3 &rarr; 8 &rarr; 12 &rarr; 17 &rarr; 18 &rarr; 13 &rarr; 9 &rarr; 4 &rarr; 0</p>
                                <p class="text-gray-500 text-sm mt-1">El Icosian Game original de Hamilton. Los 20 vertices visitados en orden.</p>
                            </div>
                            <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
                                <p class="text-cyan-400 font-medium mb-1">Icosaedro (12 vertices)</p>
                                <p class="text-gray-300 mono text-sm">0 &rarr; 1 &rarr; 10 &rarr; 6 &rarr; 2 &rarr; 7 &rarr; 11 &rarr; 8 &rarr; 3 &rarr; 4 &rarr; 9 &rarr; 5 &rarr; 0</p>
                                <p class="text-gray-500 text-sm mt-1">Zigzag entre polo norte (0), anillo superior, anillo inferior y polo sur (11).</p>
                            </div>
                        </div>

                        <p class="text-gray-300 mb-4">
                            La siguiente tabla resume la situacion. El numero de ciclos hamiltonianos distintos (considerando etiquetas de vertices, modulo direccion) da una medida de la riqueza combinatoria de cada grafo.
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Solido</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(V\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(E\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Euleriano</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Hamiltoniano</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Ciclos Ham.</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono">4</td>
                                        <td class="px-4 py-2 text-center mono">6</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">3</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono">8</td>
                                        <td class="px-4 py-2 text-center mono">12</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">6</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono">6</td>
                                        <td class="px-4 py-2 text-center mono">12</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">32</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono">20</td>
                                        <td class="px-4 py-2 text-center mono">30</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">60</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono">12</td>
                                        <td class="px-4 py-2 text-center mono">30</td>
                                        <td class="px-4 py-2 text-center text-red-400">No</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">2560</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Canvas: Hamilton Cycle on Dodecahedron -->
                        <div class="my-6">
                            <canvas id="hamilton-cycle-canvas" class="w-full rounded-xl" style="height: 400px;"></canvas>
                            <p class="text-center text-gray-500 text-sm mt-2">Ciclo hamiltoniano del dodecaedro: 20 vertices visitados en orden, aristas del ciclo en cyan</p>
                        </div>
                    </section>

                    <!-- 5. Condiciones Suficientes -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">5. Condiciones Suficientes</h3>
                        <p class="text-gray-300 mb-4">
                            Aunque no existe una caracterizacion completa, hay <strong class="text-white">condiciones suficientes</strong> clasicas que garantizan la existencia de ciclos hamiltonianos. La mas conocida es el teorema de Dirac (1952):
                        </p>

                        $$ \delta(G) \geq \frac{n}{2} \implies G \text{ es hamiltoniano} $$

                        <p class="text-gray-300 mb-4">
                            donde \(\delta(G)\) es el grado minimo del grafo y \(n = |V|\) es el numero de vertices (con \(n \geq 3\)). Dirac exige que <strong class="text-white">cada vertice</strong> tenga al menos \(n/2\) vecinos.
                        </p>
                        <p class="text-gray-300 mb-4">
                            El teorema de Ore (1960) generaliza a Dirac: si para todo par de vertices no adyacentes \(\{u,v\}\) se cumple \(\deg(u) + \deg(v) \geq n\), entonces \(G\) es hamiltoniano. Dirac es un caso particular de Ore (si \(\delta \geq n/2\), entonces toda suma de grados de no-adyacentes es al menos \(n\)).
                        </p>
                        <p class="text-gray-300 mb-4">
                            Veamos que dice Dirac sobre los grafos platonicos:
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Solido</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(n\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\delta\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(n/2\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">Dirac aplica?</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro \(K_4\)</td>
                                        <td class="px-4 py-2 text-center mono">4</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center mono">2</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si (\(3 \geq 2\))</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono">8</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center mono">4</td>
                                        <td class="px-4 py-2 text-center text-red-400">No (\(3 < 4\))</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono">6</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 text-center mono">3</td>
                                        <td class="px-4 py-2 text-center text-green-400">Si (\(4 \geq 3\))</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono">20</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center mono">10</td>
                                        <td class="px-4 py-2 text-center text-red-400">No (\(3 < 10\))</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono">12</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">5</td>
                                        <td class="px-4 py-2 text-center mono">6</td>
                                        <td class="px-4 py-2 text-center text-red-400">No (\(5 < 6\))</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300">
                            Dirac garantiza hamiltonicidad solo para el tetraedro y el octaedro. Sin embargo, el cubo, el dodecaedro y el icosaedro son hamiltonianos a pesar de no satisfacer la condicion de Dirac. Esto ilustra que estas condiciones son <strong class="text-white">suficientes pero no necesarias</strong>: un grafo puede ser hamiltoniano sin cumplirlas.
                        </p>
                    </section>

                    <!-- 6. Complejidad: P vs NP-completo -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">6. Complejidad: P vs NP-completo</h3>
                        <p class="text-gray-300 mb-4">
                            El contraste computacional entre los problemas euleriano y hamiltoniano es uno de los mas llamativos en ciencias de la computacion. Determinar si un grafo tiene un circuito euleriano es trivial algoritmicamente: basta verificar que el grafo es conexo y que todos los grados son pares. Esto se resuelve en tiempo \(O(V + E)\), lineal en el tamanio del grafo.
                        </p>

                        $$ \text{EULER} \in \mathbf{P} \quad \text{vs.} \quad \text{HAMILTON} \in \mathbf{NP\text{-completo}} $$

                        <p class="text-gray-300 mb-4">
                            En cambio, determinar si un grafo tiene un ciclo hamiltoniano es <strong class="text-white">NP-completo</strong>. No se conoce ningun algoritmo polinomial para este problema, y si existiera, implicaria que \(\mathbf{P} = \mathbf{NP}\). Los mejores algoritmos exactos tienen complejidad exponencial.
                        </p>
                        <p class="text-gray-300 mb-4">
                            El <strong class="text-white">problema del viajante</strong> (TSP, Traveling Salesman Problem) es la version de optimizacion: encontrar el ciclo hamiltoniano de peso minimo en un grafo con pesos en las aristas. TSP es NP-duro. Para los grafos platonicos con aristas de peso unitario, todos los ciclos hamiltonianos tienen la misma longitud (igual al numero de vertices), asi que la optimizacion es trivial una vez que se encuentra un ciclo.
                        </p>
                        <p class="text-gray-300">
                            Esta asimetria entre Euler y Hamilton emerge de una diferencia estructural profunda. La condicion euleriana es <strong class="text-white">local</strong> (depende solo de los grados de los vertices), mientras que la hamiltoniana es <strong class="text-white">global</strong> (depende de la estructura completa del grafo). Esta distincion local/global es recurrente en la frontera entre P y NP.
                        </p>
                    </section>

                    <!-- Ejercicios -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">Ejercicios</h3>
                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4">
                            <div>
                                <p class="text-gray-300"><strong class="text-white">1.</strong> Verifica que el octaedro es el unico solido platonico euleriano comprobando la paridad del grado de los vertices para los cinco grafos. Explica por que un grafo \(q\)-regular con \(q\) impar nunca puede ser euleriano.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">2.</strong> Encuentra un ciclo hamiltoniano para el cubo distinto al dado en el texto (0-1-3-2-6-7-5-4-0). Cuantos ciclos hamiltonianos distintos tiene el cubo? (Dos ciclos son iguales si recorren los mismos vertices en el mismo orden ciclico, ignorando la direccion.)</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">3.</strong> Comprueba si la condicion de Dirac \(\delta(G) \geq n/2\) se satisface para cada grafo platonico. Para cuales de ellos Dirac garantiza la existencia de un ciclo hamiltoniano?</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">4.</strong> El grafo de Petersen tiene 10 vertices y es 3-regular. No es hamiltoniano. Explica por que el teorema de Dirac no aplica a este grafo y por que esto no contradice el teorema.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">5.</strong> Considera un grafo donde cada vertice tiene grado exactamente 2 (una union de ciclos disjuntos). Es este grafo necesariamente hamiltoniano? Que condicion adicional se necesita?</p>
                            </div>
                        </div>
                    </section>

                    <!-- LAB -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">LAB: Route Finder</h3>
                        <p class="text-gray-400 mb-4">Selecciona un grafo y un modo (Euler o Hamilton). En modo Euler, haz clic en aristas para construir un circuito euleriano. En modo Hamilton, haz clic en vertices para construir un ciclo hamiltoniano. Usa "Mostrar solucion" para revelar un recorrido conocido.</p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                            <!-- Controls -->
                            <div class="flex flex-wrap items-center gap-2 px-4 py-3 border-b border-gray-800">
                                <button data-graph="0" class="lab-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/20 text-violet-400 border border-violet-500/30 transition">Tetraedro</button>
                                <button data-graph="1" class="lab-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Cubo</button>
                                <button data-graph="2" class="lab-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Octaedro</button>
                                <button data-graph="3" class="lab-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Dodecaedro</button>
                                <button data-graph="4" class="lab-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Icosaedro</button>
                            </div>
                            <div class="flex flex-wrap items-center gap-2 px-4 py-3 border-b border-gray-800">
                                <button id="mode-euler" class="mode-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-cyan-400 transition">Modo Euler</button>
                                <button id="mode-hamilton" class="mode-btn px-3 py-1.5 rounded-lg text-sm bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 transition">Modo Hamilton</button>
                                <button id="lab-undo" class="ml-auto px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-yellow-400 transition">Deshacer</button>
                                <button id="lab-show" class="px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-green-400 transition">Mostrar solucion</button>
                                <button id="lab-reset" class="px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-cyan-400 transition">Reset</button>
                            </div>
                            <!-- Info -->
                            <div id="lab-info" class="flex justify-center gap-6 px-4 py-2 border-b border-gray-800 text-sm mono">
                                <span class="text-gray-400">Aristas: <span id="info-edges-used" class="text-cyan-400">0</span>/<span id="info-edges-total" class="text-gray-500">6</span></span>
                                <span class="text-gray-400">Vertices: <span id="info-verts-used" class="text-violet-400">0</span>/<span id="info-verts-total" class="text-gray-500">4</span></span>
                                <span id="info-status" class="text-gray-500">Haz clic para comenzar</span>
                            </div>
                            <!-- Canvas -->
                            <div id="lab-container" class="w-full bg-black" style="height:480px; position:relative;">
                                <canvas id="lab-canvas" style="position:absolute;top:0;left:0;width:100%;height:100%;"></canvas>
                            </div>
                        </div>
                    </section>

                    <!-- Navigation -->
                    <div class="mt-12 pt-8 border-t border-gray-800 flex justify-between items-center">
                        <a href="./leccion-27.html" class="px-6 py-3 bg-gray-900 hover:bg-gray-800 rounded-lg text-gray-300 transition">
                            &larr; Anterior
                        </a>
                        <a href="./leccion-29.html" class="px-6 py-3 bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 rounded-lg transition">
                            Siguiente: Espectros, Arboles y Sintesis &rarr;
                        </a>
                    </div>
                </article>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-gray-900 py-6 mt-12">
        <div class="max-w-6xl mx-auto px-6">
            <nav class="text-xs text-gray-600 text-center mb-2">
                <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                <span class="mx-1">/</span>
                <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                <span class="mx-1">/</span>
                <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                <span class="mx-1">/</span>
                <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
            </nav>
            <p class="text-center text-gray-700 text-sm mono">Matematicas Visuales -- De Platon a 4D</p>
        </div>
    </footer>

    <script>
    // ============================================================
    // GRAPH DATA for all 5 Platonic solids
    // ============================================================
    var GRAPHS = [
        { name: 'Tetraedro', V: 4, deg: 3,
          edges: [[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]],
          euler: false, hamiltonCycle: [0,1,2,3,0] },
        { name: 'Cubo', V: 8, deg: 3,
          edges: [[0,1],[0,2],[0,4],[1,3],[1,5],[2,3],[2,6],[3,7],[4,5],[4,6],[5,7],[6,7]],
          euler: false, hamiltonCycle: [0,1,3,2,6,7,5,4,0] },
        { name: 'Octaedro', V: 6, deg: 4,
          edges: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,4],[1,5],[2,3],[2,5],[3,4],[3,5],[4,5]],
          euler: true, eulerCircuit: [0,1,2,3,4,1,5,3,0,4,5,2,0],
          hamiltonCycle: [0,1,5,4,3,2,0] },
        { name: 'Dodecaedro', V: 20, deg: 3,
          edges: [[0,1],[1,2],[2,3],[3,4],[4,0],
                  [0,5],[1,6],[2,7],[3,8],[4,9],
                  [5,10],[5,14],[6,10],[6,11],[7,11],[7,12],[8,12],[8,13],[9,13],[9,14],
                  [10,15],[11,16],[12,17],[13,18],[14,19],
                  [15,16],[16,17],[17,18],[18,19],[19,15]],
          euler: false, hamiltonCycle: [0,1,6,10,5,14,19,15,16,11,7,2,3,8,12,17,18,13,9,4,0] },
        { name: 'Icosaedro', V: 12, deg: 5,
          edges: [[0,1],[0,2],[0,3],[0,4],[0,5],
                  [1,2],[2,3],[3,4],[4,5],[5,1],
                  [1,6],[2,6],[2,7],[3,7],[3,8],[4,8],[4,9],[5,9],[5,10],[1,10],
                  [6,7],[7,8],[8,9],[9,10],[10,6],
                  [11,6],[11,7],[11,8],[11,9],[11,10]],
          euler: false, hamiltonCycle: [0,1,10,6,2,7,11,8,3,4,9,5,0] }
    ];

    function circularLayout(n, cx, cy, r) {
        var pos = [];
        for (var i = 0; i < n; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / n;
            pos.push([cx + r * Math.cos(a), cy + r * Math.sin(a)]);
        }
        return pos;
    }

    function hasEdge(graph, a, b) {
        for (var i = 0; i < graph.edges.length; i++) {
            var e = graph.edges[i];
            if ((e[0] === a && e[1] === b) || (e[0] === b && e[1] === a)) return true;
        }
        return false;
    }

    function edgeIndex(graph, a, b) {
        for (var i = 0; i < graph.edges.length; i++) {
            var e = graph.edges[i];
            if ((e[0] === a && e[1] === b) || (e[0] === b && e[1] === a)) return i;
        }
        return -1;
    }

    function dodecahedronLayout(cx, cy, maxR) {
        var r1 = maxR * 0.28;
        var r2 = maxR * 0.52;
        var r3 = maxR * 0.76;
        var r4 = maxR;
        var pos = [];
        for (var i = 0; i < 5; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / 5;
            pos.push([cx + r1 * Math.cos(a), cy + r1 * Math.sin(a)]);
        }
        for (var i = 0; i < 5; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / 5 + Math.PI / 5;
            pos.push([cx + r2 * Math.cos(a), cy + r2 * Math.sin(a)]);
        }
        for (var i = 0; i < 5; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / 5;
            pos.push([cx + r3 * Math.cos(a), cy + r3 * Math.sin(a)]);
        }
        for (var i = 0; i < 5; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / 5 + Math.PI / 5;
            pos.push([cx + r4 * Math.cos(a), cy + r4 * Math.sin(a)]);
        }
        return pos;
    }

    // ============================================================
    // ILLUSTRATION 1: Euler Circuit of the Octahedron
    // ============================================================
    (function() {
        var c = document.getElementById('euler-circuit-canvas');
        if (!c) return;
        var W = c.clientWidth, H = c.clientHeight;
        var dpr = window.devicePixelRatio || 1;
        c.width = W * dpr; c.height = H * dpr;
        var ctx = c.getContext('2d');
        ctx.scale(dpr, dpr);

        var g = GRAPHS[2]; // octahedron
        var circuit = [0,1,2,3,4,1,5,3,0,4,5,2,0];
        var cx = W / 2, cy = H / 2 - 10;
        var r = Math.min(W, H) / 2 - 55;
        var pos = circularLayout(6, cx, cy, r);

        // Draw all edges in dim gray first
        ctx.strokeStyle = 'rgba(107, 114, 128, 0.2)';
        ctx.lineWidth = 1;
        for (var i = 0; i < g.edges.length; i++) {
            var a = g.edges[i][0], b = g.edges[i][1];
            ctx.beginPath();
            ctx.moveTo(pos[a][0], pos[a][1]);
            ctx.lineTo(pos[b][0], pos[b][1]);
            ctx.stroke();
        }

        // Draw the Euler circuit with numbered edges
        var colors = [
            '#22d3ee', '#38bdf8', '#818cf8', '#a78bfa', '#c084fc',
            '#e879f9', '#f472b6', '#fb7185', '#f97316', '#facc15',
            '#a3e635', '#34d399'
        ];
        for (var i = 0; i < circuit.length - 1; i++) {
            var a = circuit[i], b = circuit[i + 1];
            var col = colors[i % colors.length];
            ctx.strokeStyle = col;
            ctx.lineWidth = 2.5;
            ctx.beginPath();
            ctx.moveTo(pos[a][0], pos[a][1]);
            ctx.lineTo(pos[b][0], pos[b][1]);
            ctx.stroke();
            // Number at midpoint with perpendicular offset
            var mx = (pos[a][0] + pos[b][0]) / 2;
            var my = (pos[a][1] + pos[b][1]) / 2;
            var dx = pos[b][0] - pos[a][0], dy = pos[b][1] - pos[a][1];
            var len = Math.sqrt(dx * dx + dy * dy);
            if (len < 0.01) continue;
            var nx = -dy / len * 14, ny = dx / len * 14;
            var side = (i % 2 === 0) ? 1 : -1;
            mx += nx * side;
            my += ny * side;
            ctx.fillStyle = col;
            ctx.font = 'bold 11px "JetBrains Mono", monospace';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('' + (i + 1), mx, my);
        }

        // Draw vertices
        for (var i = 0; i < 6; i++) {
            ctx.beginPath();
            ctx.arc(pos[i][0], pos[i][1], 14, 0, Math.PI * 2);
            ctx.fillStyle = '#111827';
            ctx.fill();
            ctx.strokeStyle = '#a78bfa';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = '#e5e7eb';
            ctx.font = '13px "JetBrains Mono", monospace';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('' + i, pos[i][0], pos[i][1]);
        }

        // Legend at bottom
        ctx.fillStyle = '#6b7280';
        ctx.font = '11px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Circuito: 0\u21921\u21922\u21923\u21924\u21921\u21925\u21923\u21920\u21924\u21925\u21922\u21920  (12 aristas)', cx, H - 12);
    })();

    // ============================================================
    // ILLUSTRATION 2: Hamilton Cycle on the Dodecahedron
    // ============================================================
    (function() {
        var c = document.getElementById('hamilton-cycle-canvas');
        if (!c) return;
        var W = c.clientWidth, H = c.clientHeight;
        var dpr = window.devicePixelRatio || 1;
        c.width = W * dpr; c.height = H * dpr;
        var ctx = c.getContext('2d');
        ctx.scale(dpr, dpr);

        var g = GRAPHS[3]; // dodecahedron
        var cycle = g.hamiltonCycle;
        var cx = W / 2, cy = H / 2;
        var maxR = Math.min(W, H) / 2 - 35;
        var pos = dodecahedronLayout(cx, cy, maxR);

        // Draw all edges in dim gray
        ctx.strokeStyle = 'rgba(107, 114, 128, 0.18)';
        ctx.lineWidth = 1;
        for (var i = 0; i < g.edges.length; i++) {
            var a = g.edges[i][0], b = g.edges[i][1];
            ctx.beginPath();
            ctx.moveTo(pos[a][0], pos[a][1]);
            ctx.lineTo(pos[b][0], pos[b][1]);
            ctx.stroke();
        }

        // Draw Hamiltonian cycle edges
        ctx.strokeStyle = '#22d3ee';
        ctx.lineWidth = 2.5;
        ctx.shadowColor = 'rgba(34, 211, 238, 0.4)';
        ctx.shadowBlur = 8;
        for (var i = 0; i < cycle.length - 1; i++) {
            var a = cycle[i], b = cycle[i + 1];
            ctx.beginPath();
            ctx.moveTo(pos[a][0], pos[a][1]);
            ctx.lineTo(pos[b][0], pos[b][1]);
            ctx.stroke();
        }
        ctx.shadowBlur = 0;

        // Draw vertices with visit order
        for (var i = 0; i < 20; i++) {
            ctx.beginPath();
            ctx.arc(pos[i][0], pos[i][1], 11, 0, Math.PI * 2);
            ctx.fillStyle = '#111827';
            ctx.fill();
            ctx.strokeStyle = '#a78bfa';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = '#e5e7eb';
            ctx.font = '9px "JetBrains Mono", monospace';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('' + i, pos[i][0], pos[i][1]);
        }
    })();

    // ============================================================
    // LAB: Route Finder (Euler / Hamilton)
    // ============================================================
    (function() {
        var container = document.getElementById('lab-container');
        var canvas = document.getElementById('lab-canvas');
        if (!container || !canvas) return;

        var W, H, dpr, ctx;
        var currentGraph = 0;
        var mode = 'hamilton';
        var positions = [];
        var path = [];
        var usedEdges = {};
        var showingSolution = false;

        function resize() {
            W = container.clientWidth;
            H = container.clientHeight;
            dpr = window.devicePixelRatio || 1;
            canvas.width = W * dpr;
            canvas.height = H * dpr;
            ctx = canvas.getContext('2d');
            ctx.scale(dpr, dpr);
        }

        function initPositions() {
            var g = GRAPHS[currentGraph];
            if (currentGraph === 3) {
                var maxR = Math.min(W, H) / 2 - 40;
                positions = dodecahedronLayout(W / 2, H / 2, maxR);
            } else {
                positions = circularLayout(g.V, W / 2, H / 2, Math.min(W, H) / 2 - 50);
            }
            resetPath();
        }

        function resetPath() {
            path = [];
            usedEdges = {};
            showingSolution = false;
            updateInfo();
        }

        function getVisitedVerts() {
            var s = {};
            for (var i = 0; i < path.length; i++) s[path[i]] = true;
            return s;
        }

        function countUsedEdges() {
            var count = 0;
            for (var k in usedEdges) if (usedEdges[k]) count++;
            return count;
        }

        function updateInfo() {
            var g = GRAPHS[currentGraph];
            document.getElementById('info-edges-total').textContent = g.edges.length;
            document.getElementById('info-verts-total').textContent = g.V;
            document.getElementById('info-edges-used').textContent = countUsedEdges();
            var visitedCount = Object.keys(getVisitedVerts()).length;
            document.getElementById('info-verts-used').textContent = visitedCount;

            var status = document.getElementById('info-status');
            if (showingSolution) {
                status.textContent = 'Solucion mostrada';
                status.className = 'text-green-400';
            } else if (path.length === 0) {
                if (mode === 'euler' && !g.euler) {
                    status.textContent = 'No existe circuito euleriano (grado impar)';
                    status.className = 'text-red-400';
                } else {
                    status.textContent = 'Haz clic para comenzar';
                    status.className = 'text-gray-500';
                }
            } else if (mode === 'hamilton') {
                if (visitedCount === g.V && path.length > 1 && path[path.length - 1] === path[0]) {
                    status.textContent = 'Ciclo hamiltoniano completo!';
                    status.className = 'text-green-400';
                } else if (visitedCount === g.V) {
                    status.textContent = 'Todos visitados. Cierra el ciclo volviendo al inicio!';
                    status.className = 'text-yellow-400';
                } else {
                    status.textContent = 'Construyendo camino... (' + visitedCount + '/' + g.V + ')';
                    status.className = 'text-cyan-400';
                }
            } else {
                var eu = countUsedEdges();
                if (eu === g.edges.length && path.length > 1 && path[path.length - 1] === path[0]) {
                    status.textContent = 'Circuito euleriano completo!';
                    status.className = 'text-green-400';
                } else {
                    status.textContent = 'Construyendo circuito... (' + eu + '/' + g.edges.length + ')';
                    status.className = 'text-cyan-400';
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, W, H);
            var g = GRAPHS[currentGraph];
            var vr = g.V <= 8 ? 14 : (g.V <= 12 ? 11 : 9);

            // Draw all edges
            for (var i = 0; i < g.edges.length; i++) {
                var a = g.edges[i][0], b = g.edges[i][1];
                ctx.beginPath();
                ctx.moveTo(positions[a][0], positions[a][1]);
                ctx.lineTo(positions[b][0], positions[b][1]);
                if (usedEdges[i]) {
                    ctx.strokeStyle = '#22d3ee';
                    ctx.lineWidth = 3;
                } else {
                    ctx.strokeStyle = 'rgba(107, 114, 128, 0.3)';
                    ctx.lineWidth = 1.2;
                }
                ctx.stroke();
            }

            // Draw step numbers along path
            if (path.length > 1) {
                for (var i = 0; i < path.length - 1; i++) {
                    var a = path[i], b = path[i + 1];
                    var mx = (positions[a][0] + positions[b][0]) / 2;
                    var my = (positions[a][1] + positions[b][1]) / 2;
                    var dx = positions[b][0] - positions[a][0];
                    var dy = positions[b][1] - positions[a][1];
                    var len = Math.sqrt(dx * dx + dy * dy);
                    if (len < 1) continue;
                    var nx = -dy / len * 13, ny = dx / len * 13;
                    var side = (i % 2 === 0) ? 1 : -1;
                    ctx.fillStyle = 'rgba(34, 211, 238, 0.7)';
                    ctx.font = 'bold 10px "JetBrains Mono", monospace';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText('' + (i + 1), mx + nx * side, my + ny * side);
                }
            }

            // Draw vertices
            var visited = getVisitedVerts();
            for (var i = 0; i < g.V; i++) {
                ctx.beginPath();
                ctx.arc(positions[i][0], positions[i][1], vr, 0, Math.PI * 2);
                if (path.length > 0 && path.length > 1 && i === path[path.length - 1] && path[path.length - 1] === path[0]) {
                    ctx.fillStyle = '#22c55e';
                } else if (path.length > 0 && i === path[path.length - 1]) {
                    ctx.fillStyle = '#22d3ee';
                } else if (path.length > 0 && i === path[0]) {
                    ctx.fillStyle = '#a78bfa';
                } else if (visited[i]) {
                    ctx.fillStyle = 'rgba(167, 139, 250, 0.4)';
                } else {
                    ctx.fillStyle = 'rgba(107, 114, 128, 0.25)';
                }
                ctx.fill();
                ctx.strokeStyle = visited[i] ? '#a78bfa' : 'rgba(107, 114, 128, 0.4)';
                ctx.lineWidth = 1.5;
                ctx.stroke();

                ctx.fillStyle = '#e5e7eb';
                ctx.font = (g.V <= 12 ? '12' : '9') + 'px "JetBrains Mono", monospace';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('' + i, positions[i][0], positions[i][1]);
            }

            // Highlight clickable targets
            if (!showingSolution && path.length > 0) {
                var last = path[path.length - 1];
                // Check if cycle is already complete
                if (path.length > 1 && path[path.length - 1] === path[0]) return;
                if (mode === 'hamilton') {
                    var visitedSet = getVisitedVerts();
                    var allDone = Object.keys(visitedSet).length === g.V;
                    for (var i = 0; i < g.V; i++) {
                        if (i === last) continue;
                        if (!hasEdge(g, last, i)) continue;
                        if (!visitedSet[i] || (i === path[0] && allDone)) {
                            ctx.beginPath();
                            ctx.arc(positions[i][0], positions[i][1], vr + 5, 0, Math.PI * 2);
                            ctx.strokeStyle = 'rgba(34, 211, 238, 0.25)';
                            ctx.lineWidth = 2;
                            ctx.stroke();
                        }
                    }
                } else {
                    // Euler mode: highlight reachable unused edges
                    for (var i = 0; i < g.edges.length; i++) {
                        if (usedEdges[i]) continue;
                        var e = g.edges[i];
                        if (e[0] !== last && e[1] !== last) continue;
                        var other = (e[0] === last) ? e[1] : e[0];
                        ctx.beginPath();
                        ctx.moveTo(positions[e[0]][0], positions[e[0]][1]);
                        ctx.lineTo(positions[e[1]][0], positions[e[1]][1]);
                        ctx.strokeStyle = 'rgba(34, 211, 238, 0.2)';
                        ctx.lineWidth = 6;
                        ctx.stroke();
                    }
                }
            }
        }

        function findVertex(mx, my) {
            var g = GRAPHS[currentGraph];
            var vr = g.V <= 8 ? 18 : (g.V <= 12 ? 15 : 13);
            for (var i = 0; i < g.V; i++) {
                var dx = mx - positions[i][0], dy = my - positions[i][1];
                if (dx * dx + dy * dy < vr * vr) return i;
            }
            return -1;
        }

        function findClosestEdgeFrom(mx, my, fromVertex) {
            var g = GRAPHS[currentGraph];
            var best = -1, bestDist = 20;
            for (var i = 0; i < g.edges.length; i++) {
                if (usedEdges[i]) continue;
                var e = g.edges[i];
                if (e[0] !== fromVertex && e[1] !== fromVertex) continue;
                var other = (e[0] === fromVertex) ? e[1] : e[0];
                // Distance from click to the other endpoint
                var dx = mx - positions[other][0], dy = my - positions[other][1];
                var d = Math.sqrt(dx * dx + dy * dy);
                if (d < bestDist) { bestDist = d; best = i; }
            }
            return best;
        }

        function handleClick(mx, my) {
            if (showingSolution) return;
            var g = GRAPHS[currentGraph];

            // Check if already complete
            if (path.length > 1 && path[path.length - 1] === path[0]) return;

            if (mode === 'hamilton') {
                var v = findVertex(mx, my);
                if (v < 0) return;

                if (path.length === 0) {
                    path.push(v);
                } else {
                    var last = path[path.length - 1];
                    if (!hasEdge(g, last, v)) return;
                    var visited = getVisitedVerts();
                    if (v === path[0] && Object.keys(visited).length === g.V) {
                        path.push(v);
                        var eIdx = edgeIndex(g, last, v);
                        if (eIdx >= 0) usedEdges[eIdx] = true;
                    } else if (!visited[v]) {
                        path.push(v);
                        var eIdx = edgeIndex(g, last, v);
                        if (eIdx >= 0) usedEdges[eIdx] = true;
                    } else {
                        return;
                    }
                }
            } else {
                if (!g.euler) return;

                if (path.length === 0) {
                    var v = findVertex(mx, my);
                    if (v >= 0) path.push(v);
                } else {
                    var last = path[path.length - 1];
                    // Find the vertex clicked and check if there's an unused edge
                    var v = findVertex(mx, my);
                    if (v < 0) return;
                    if (v === last) return;
                    var eIdx = edgeIndex(g, last, v);
                    if (eIdx < 0 || usedEdges[eIdx]) return;
                    usedEdges[eIdx] = true;
                    path.push(v);
                }
            }

            updateInfo();
            draw();
        }

        function undoStep() {
            if (showingSolution || path.length <= 1) return;
            var g = GRAPHS[currentGraph];
            var removed = path.pop();
            if (path.length > 0) {
                var prev = path[path.length - 1];
                var eIdx = edgeIndex(g, prev, removed);
                if (eIdx >= 0) delete usedEdges[eIdx];
            }
            updateInfo();
            draw();
        }

        function showSolution() {
            var g = GRAPHS[currentGraph];
            path = [];
            usedEdges = {};
            showingSolution = true;

            if (mode === 'hamilton') {
                path = g.hamiltonCycle.slice();
                for (var i = 0; i < path.length - 1; i++) {
                    var eIdx = edgeIndex(g, path[i], path[i + 1]);
                    if (eIdx >= 0) usedEdges[eIdx] = true;
                }
            } else {
                if (!g.euler) {
                    updateInfo();
                    draw();
                    return;
                }
                path = g.eulerCircuit.slice();
                for (var i = 0; i < path.length - 1; i++) {
                    var eIdx = edgeIndex(g, path[i], path[i + 1]);
                    if (eIdx >= 0) usedEdges[eIdx] = true;
                }
            }

            updateInfo();
            draw();
        }

        function getMousePos(e) {
            var rect = canvas.getBoundingClientRect();
            return [e.clientX - rect.left, e.clientY - rect.top];
        }

        canvas.addEventListener('click', function(e) {
            var p = getMousePos(e);
            handleClick(p[0], p[1]);
        });

        canvas.addEventListener('touchend', function(e) {
            e.preventDefault();
            if (e.changedTouches.length > 0) {
                var t = e.changedTouches[0];
                var rect = canvas.getBoundingClientRect();
                handleClick(t.clientX - rect.left, t.clientY - rect.top);
            }
        });

        // Graph selection buttons
        var btns = document.querySelectorAll('.lab-btn');
        btns.forEach(function(btn) {
            btn.addEventListener('click', function() {
                currentGraph = parseInt(this.getAttribute('data-graph'));
                btns.forEach(function(b) {
                    b.className = 'lab-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition';
                });
                this.className = 'lab-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/20 text-violet-400 border border-violet-500/30 transition';
                initPositions();
                draw();
            });
        });

        // Mode buttons
        document.getElementById('mode-euler').addEventListener('click', function() {
            mode = 'euler';
            this.className = 'mode-btn px-3 py-1.5 rounded-lg text-sm bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 transition';
            document.getElementById('mode-hamilton').className = 'mode-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-cyan-400 transition';
            resetPath();
            updateInfo();
            draw();
        });
        document.getElementById('mode-hamilton').addEventListener('click', function() {
            mode = 'hamilton';
            this.className = 'mode-btn px-3 py-1.5 rounded-lg text-sm bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 transition';
            document.getElementById('mode-euler').className = 'mode-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-cyan-400 transition';
            resetPath();
            updateInfo();
            draw();
        });

        document.getElementById('lab-show').addEventListener('click', showSolution);
        document.getElementById('lab-undo').addEventListener('click', undoStep);
        document.getElementById('lab-reset').addEventListener('click', function() {
            resetPath();
            updateInfo();
            draw();
        });

        // Init
        resize();
        initPositions();
        updateInfo();
        draw();
        window.addEventListener('resize', function() { resize(); initPositions(); draw(); });
    })();
    </script>
</body>
</html>
