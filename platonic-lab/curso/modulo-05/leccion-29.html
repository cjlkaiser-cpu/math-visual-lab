<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leccion 29: Espectros, Arboles y Sintesis | Matematicas Visuales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glow-text { text-shadow: 0 0 20px rgba(168, 85, 247, 0.5); }
        .progress-bar { background: linear-gradient(90deg, #a855f7, #22d3ee); }
        .katex { color: inherit; font-size: 1.1em; }
    </style>
</head>
<body class="bg-black text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="border-b border-gray-900 bg-black/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <nav class="text-xs text-gray-600 mb-1">
                        <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                        <span class="mx-1">/</span>
                        <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                        <span class="mx-1">/</span>
                        <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
                        <span class="mx-1">/</span>
                        <span class="text-gray-500">Modulo 05</span>
                    </nav>
                    <h1 class="text-lg font-light">
                        <span class="text-violet-400 font-medium glow-text">Leccion 29</span> â€” Espectros, Arboles y Sintesis
                    </h1>
                </div>
                <nav class="flex gap-2 text-sm">
                    <a href="./leccion-28.html" class="px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 transition">&larr; Anterior</a>
                    <a href="../modulo-06/leccion-30.html" class="px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 transition">Siguiente &rarr;</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="max-w-6xl mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-1">
                <div class="bg-gray-950 border border-gray-900 rounded-2xl p-6 sticky top-24">
                    <h3 class="text-lg font-semibold mb-4 text-cyan-400">Modulo 05</h3>
                    <p class="text-sm text-gray-500 mb-4">Teoria de Grafos</p>

                    <div class="mb-6">
                        <div class="flex justify-between text-xs text-gray-400 mb-2">
                            <span>Progreso</span>
                            <span>5/5</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-2">
                            <div class="progress-bar h-2 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>

                    <nav class="space-y-2">
                        <a href="./leccion-25.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">25. De Poliedros a Grafos</a>
                        <a href="./leccion-26.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">26. Grafos Planares y Steinitz</a>
                        <a href="./leccion-27.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">27. Coloracion de Grafos</a>
                        <a href="./leccion-28.html" class="block px-3 py-2 rounded-lg hover:bg-gray-900 text-gray-400 text-sm transition">28. Recorridos: Euler y Hamilton</a>
                        <a href="./leccion-29.html" class="block px-3 py-2 rounded-lg bg-violet-500/10 text-violet-400 text-sm">29. Espectros, Arboles y Sintesis</a>
                    </nav>
                </div>
            </aside>

            <!-- Content -->
            <main class="lg:col-span-3">
                <article class="bg-gray-950 border border-gray-900 rounded-2xl p-8">
                    <div class="mb-8">
                        <span class="text-cyan-400 text-sm font-medium">Leccion 29</span>
                        <h2 class="text-3xl font-light mt-2 mb-4">
                            <span class="text-violet-400 font-medium glow-text">Espectros, Arboles</span> y Sintesis
                        </h2>
                        <p class="text-gray-400 text-lg">El Laplaciano revela la estructura algebraica de un grafo. Kirchhoff cuenta arboles. El gran arco del curso se cierra.</p>
                    </div>

                    <!-- 1. Arboles de Expansion -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">1. Arboles de Expansion</h3>
                        <p class="text-gray-300 mb-4">
                            Un <strong class="text-white">arbol</strong> es un grafo conexo sin ciclos. Un arbol con \(n\) vertices tiene exactamente \(n - 1\) aristas. Dado un grafo conexo \(G\), un <strong class="text-white">arbol de expansion</strong> (spanning tree) es un subgrafo que es arbol y contiene todos los vertices de \(G\). Se obtiene eliminando aristas hasta suprimir todos los ciclos, sin desconectar el grafo.
                        </p>
                        <p class="text-gray-300 mb-4">
                            Todo grafo conexo tiene al menos un arbol de expansion. Notamos \(\tau(G)\) al numero de arboles de expansion de \(G\). Este numero puede ser enorme: para el grafo completo \(K_n\), la <strong class="text-white">formula de Cayley</strong> establece:
                        </p>

                        $$ \tau(K_n) = n^{n-2} $$

                        <p class="text-gray-300 mb-4">
                            Verificacion directa: \(\tau(K_3) = 3^1 = 3\) (los tres arboles se obtienen eliminando una de las tres aristas), y \(\tau(K_4) = 4^2 = 16\).
                        </p>
                        <p class="text-gray-300 mb-4">
                            Para un poliedro con \(V\) vertices y \(E\) aristas, cada arbol de expansion tiene exactamente \(V - 1\) aristas, asi que se eliminan \(E - V + 1\) aristas. Por la formula de Euler, \(E - V + 1 = F - 1\), donde \(F\) es el numero de caras. El numero de aristas eliminadas es exactamente \(F - 1\).
                        </p>

                        <!-- Canvas: Spanning Tree of the Cube -->
                        <div class="my-6">
                            <canvas id="spanning-tree-canvas" class="w-full rounded-xl" style="height: 280px;"></canvas>
                            <p class="text-center text-gray-500 text-sm mt-2">Arbol de expansion del cubo: 7 aristas en cyan (arbol), 5 aristas en gris (eliminadas)</p>
                        </div>
                    </section>

                    <!-- 2. El Teorema de Kirchhoff (Matrix-Tree) -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">2. El Teorema de Kirchhoff (Matrix-Tree)</h3>
                        <p class="text-gray-300 mb-4">
                            La <strong class="text-white">matriz laplaciana</strong> de un grafo \(G\) es \(L = D - A\), donde \(D\) es la matriz diagonal de grados y \(A\) es la matriz de adyacencia. Explicitamente:
                        </p>

                        $$ L_{ij} = \begin{cases} \deg(v_i) & \text{si } i = j \\ -1 & \text{si } \{v_i, v_j\} \in E \\ 0 & \text{en otro caso} \end{cases} $$

                        <p class="text-gray-300 mb-4">
                            El <strong class="text-white">teorema de Kirchhoff</strong> (Matrix-Tree theorem) proporciona una formula exacta para contar arboles de expansion: \(\tau(G)\) es igual a cualquier cofactor de \(L\) (todos los cofactores son iguales):
                        </p>

                        $$ \tau(G) = \det(L_{11}) $$

                        <p class="text-gray-300 mb-4">
                            donde \(L_{11}\) es la matriz \(L\) con la primera fila y la primera columna eliminadas.
                        </p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 mb-4">
                            <p class="text-gray-300 mb-2"><strong class="text-cyan-400">Ejemplo: Tetraedro (\(K_4\))</strong></p>
                            <p class="text-gray-300 mb-2 mono text-sm">
                                D = diag(3,3,3,3), &nbsp; A = J - I
                            </p>
                            <p class="text-gray-300 mb-2">
                                La laplaciana es \(L = D - A = 4I - J\):
                            </p>

                            $$ L = \begin{pmatrix} 3 & -1 & -1 & -1 \\ -1 & 3 & -1 & -1 \\ -1 & -1 & 3 & -1 \\ -1 & -1 & -1 & 3 \end{pmatrix} $$

                            <p class="text-gray-300 mb-2">
                                Eliminando fila 0 y columna 0:
                            </p>

                            $$ L_{11} = \begin{pmatrix} 3 & -1 & -1 \\ -1 & 3 & -1 \\ -1 & -1 & 3 \end{pmatrix} $$

                            <p class="text-gray-300 mono text-sm">
                                det(L<sub>11</sub>) = 3(9-1) - (-1)(-3-1) + (-1)(1+3) = 24 - 4 - 4 = 16
                            </p>
                            <p class="text-gray-300 mt-2">
                                Resultado: \(\tau(K_4) = 16\), que coincide con Cayley: \(4^2 = 16\).
                            </p>
                        </div>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6">
                            <p class="text-gray-300 mb-2"><strong class="text-cyan-400">Ejemplo: Cubo</strong></p>
                            <p class="text-gray-300">
                                Aplicando el mismo procedimiento al cubo (8 vertices, 3-regular), se obtiene \(\tau(\text{cubo}) = 384\). La verificacion completa requiere calcular el determinante de una matriz \(7 \times 7\), pero el resultado puede confirmarse computacionalmente.
                            </p>
                        </div>
                    </section>

                    <!-- 3. Espectro del Laplaciano -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">3. Espectro del Laplaciano</h3>
                        <p class="text-gray-300 mb-4">
                            Los autovalores de \(L\) se denominan el <strong class="text-white">espectro laplaciano</strong> del grafo: \(0 = \lambda_1 \leq \lambda_2 \leq \cdots \leq \lambda_n\). La matriz \(L\) es positiva semidefinida, asi que todos los autovalores son no negativos.
                        </p>
                        <p class="text-gray-300 mb-4">
                            El autovalor \(\lambda_1 = 0\) siempre existe, con autovector el vector de unos \(\mathbf{1} = (1, 1, \ldots, 1)^T\). Esto es inmediato: cada fila de \(L\) suma cero, asi que \(L\mathbf{1} = \mathbf{0}\).
                        </p>
                        <p class="text-gray-300 mb-4">
                            Propiedades fundamentales del espectro:
                        </p>
                        <ul class="list-disc list-inside text-gray-300 mb-4 space-y-2">
                            <li>La <strong class="text-white">multiplicidad</strong> del autovalor 0 es igual al numero de componentes conexas del grafo.</li>
                            <li>El segundo autovalor \(\lambda_2\) se llama <strong class="text-white">conectividad algebraica</strong> (valor de Fiedler). Se cumple \(\lambda_2 > 0\) si y solo si \(G\) es conexo.</li>
                            <li>Un valor mayor de \(\lambda_2\) indica un grafo "mas conectado": mas dificil de desconectar eliminando aristas.</li>
                        </ul>
                        <p class="text-gray-300 mb-4">
                            Los espectros laplacianos de los grafos platonicos revelan su estructura. Los autovalores de la adyacencia se obtienen de la teoria de grafos fuertemente regulares y grafos multipartitos completos. Como \(L = D - A\), los autovalores laplacianos son \(\lambda_i^{(L)} = q - \lambda_i^{(A)}\), donde \(q\) es el grado.
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Grafo</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\lambda_2\)</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Espectro laplaciano</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 mono text-sm">{0, 4, 4, 4}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">2</td>
                                        <td class="px-4 py-2 mono text-sm">{0, 2, 2, 2, 4, 4, 4, 6}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 mono text-sm">{0, 4, 4, 6, 6, 6}</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">&asymp; 0.764</td>
                                        <td class="px-4 py-2 text-sm">\(3 - \sqrt{5} \approx 0.764\)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">&asymp; 2.764</td>
                                        <td class="px-4 py-2 text-sm">\(5 - \sqrt{5} \approx 2.764\)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300 mb-4">
                            El tetraedro y el octaedro comparten \(\lambda_2 = 4\), la mayor conectividad algebraica entre los platonicos. El dodecaedro tiene la menor (\(\lambda_2 \approx 0.764\)), reflejando que es el "menos conectado" en proporcion a su tamanio: 20 vertices con grado apenas 3.
                        </p>

                        <!-- Canvas: Spectrum Bar Chart -->
                        <div class="my-6">
                            <canvas id="spectrum-canvas" class="w-full rounded-xl" style="height: 240px;"></canvas>
                            <p class="text-center text-gray-500 text-sm mt-2">Espectro laplaciano del tetraedro: autovalores {0, 4, 4, 4}</p>
                        </div>
                    </section>

                    <!-- 4. Conjuntos Independientes y Cliques -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">4. Conjuntos Independientes y Cliques</h3>
                        <p class="text-gray-300 mb-4">
                            Un <strong class="text-white">conjunto independiente</strong> es un conjunto de vertices mutuamente no adyacentes. El <strong class="text-white">numero de independencia</strong> \(\alpha(G)\) es el tamanio maximo de un conjunto independiente. Un <strong class="text-white">clique</strong> es un conjunto de vertices mutuamente adyacentes. El <strong class="text-white">numero de clique</strong> \(\omega(G)\) es el tamanio maximo de un clique.
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Grafo</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\alpha(G)\)</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\omega(G)\)</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Observacion</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">1</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">4</td>
                                        <td class="px-4 py-2 text-sm">Completo: todo par es adyacente</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">2</td>
                                        <td class="px-4 py-2 text-sm">Bipartito, sin triangulos (cintura 4)</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">2</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">3</td>
                                        <td class="px-4 py-2 text-sm">Un par antipodal; triangulos presentes</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">8</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">2</td>
                                        <td class="px-4 py-2 text-sm">Sin triangulos (cintura 5)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">3</td>
                                        <td class="px-4 py-2 text-center mono text-cyan-400">3</td>
                                        <td class="px-4 py-2 text-sm">Tiene triangulos como caras</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300 mb-4">
                            Estos invariantes se relacionan con la coloracion. Si \(\chi(G)\) es el numero cromatico, el principio del palomar garantiza:
                        </p>

                        $$ \alpha(G) \cdot \chi(G) \geq |V| $$

                        <p class="text-gray-300">
                            Verificacion para el cubo: \(\alpha = 4\), \(\chi = 2\), \(|V| = 8\), y \(4 \cdot 2 = 8 \geq 8\). Para el dodecaedro: \(\alpha = 8\), \(\chi = 3\), \(|V| = 20\), y \(8 \cdot 3 = 24 \geq 20\).
                        </p>
                    </section>

                    <!-- 5. Numero de Dominacion -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">5. Numero de Dominacion</h3>
                        <p class="text-gray-300 mb-4">
                            Un <strong class="text-white">conjunto dominante</strong> es un subconjunto \(S \subseteq V\) tal que todo vertice de \(G\) esta en \(S\) o es adyacente a algun vertice de \(S\). El <strong class="text-white">numero de dominacion</strong> \(\gamma(G)\) es el tamanio minimo de un conjunto dominante.
                        </p>
                        <p class="text-gray-300 mb-4">
                            Cada vertice de grado \(q\) "domina" a lo sumo \(q + 1\) vertices (si mismo y sus vecinos), lo que da la cota inferior \(\gamma(G) \geq \lceil V / (q + 1) \rceil\).
                        </p>

                        <div class="overflow-x-auto mb-6">
                            <table class="w-full text-sm text-gray-300">
                                <thead>
                                    <tr class="border-b border-gray-800">
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Grafo</th>
                                        <th class="px-4 py-3 text-center text-gray-400 font-medium">\(\gamma(G)\)</th>
                                        <th class="px-4 py-3 text-left text-gray-400 font-medium">Justificacion</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Tetraedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">1</td>
                                        <td class="px-4 py-2 text-sm">Cualquier vertice es adyacente a todos los demas</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Cubo</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">2</td>
                                        <td class="px-4 py-2 text-sm">Dos vertices diagonalmente opuestos dominan los 8</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Octaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">2</td>
                                        <td class="px-4 py-2 text-sm">Un vertice cubre 5 de 6; se necesitan al menos 2</td>
                                    </tr>
                                    <tr class="border-b border-gray-900">
                                        <td class="px-4 py-2">Dodecaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">4</td>
                                        <td class="px-4 py-2 text-sm">Cada vertice cubre 4; se requieren al menos \(\lceil 20/4 \rceil = 5\), alcanzable con 4</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-2">Icosaedro</td>
                                        <td class="px-4 py-2 text-center mono text-violet-400">2</td>
                                        <td class="px-4 py-2 text-sm">Dos vertices antipodales cubren los 12</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <p class="text-gray-300">
                            El icosaedro admite \(\gamma = 2\) porque cada vertice tiene grado 5, dominando 6 vertices. Dos vertices sin vecinos comunes cubren \(6 + 6 = 12\) vertices, la totalidad del grafo. El dodecaedro, con grado 3, necesita mas vertices dominantes para cubrir sus 20 vertices.
                        </p>
                    </section>

                    <!-- 6. Sintesis del Modulo 5 -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">6. Sintesis del Modulo 5</h3>
                        <p class="text-gray-300 mb-4">
                            Este modulo ha explorado los solidos platonicos desde la perspectiva de la teoria de grafos. Recapitulamos las cinco lecciones:
                        </p>
                        <ul class="list-none text-gray-300 space-y-3 mb-4">
                            <li><strong class="text-white">L25 -- De Poliedros a Grafos.</strong> El grafo esqueleto \(G(P)\), la matriz de adyacencia, el lema del apreton de manos. Los cinco grafos platonicos como objetos combinatorios.</li>
                            <li><strong class="text-white">L26 -- Grafos Planares y Steinitz.</strong> Planaridad, la formula de Euler \(V - E + F = 2\) para grafos planares, los teoremas de Kuratowski y Steinitz. Cada grafo platonico es 3-conexo y planar.</li>
                            <li><strong class="text-white">L27 -- Coloracion de Grafos.</strong> Numeros cromaticos, el teorema de los cuatro colores, el polinomio cromatico. Los cinco grafos platonicos como banco de pruebas.</li>
                            <li><strong class="text-white">L28 -- Recorridos: Euler y Hamilton.</strong> Circuitos eulerianos (ninguno de los platonicos los tiene), circuitos hamiltonianos (todos los platonicos los tienen). El contraste P vs. NP.</li>
                            <li><strong class="text-white">L29 -- Espectros, Arboles y Sintesis.</strong> El laplaciano, el teorema de Kirchhoff, conectividad algebraica, conjuntos independientes, cliques y dominacion.</li>
                        </ul>
                        <p class="text-gray-300">
                            Los cinco grafos platonicos funcionan como un <strong class="text-white">banco de pruebas</strong> ideal: son lo bastante simples para calcular a mano, pero lo bastante ricos para ilustrar todos los conceptos fundamentales de teoria de grafos.
                        </p>
                    </section>

                    <!-- 7. El Gran Arco -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-violet-400 mb-4">7. El Gran Arco</h3>
                        <p class="text-gray-300 mb-4">
                            Con esta leccion se cierra el arco principal del curso. Revisamos la trayectoria completa:
                        </p>
                        <ul class="list-none text-gray-300 space-y-3 mb-4">
                            <li><strong class="text-cyan-400">Modulo 1:</strong> Los cinco solidos platonicos -- geometria euclidiana, la formula de Euler, la clasificacion completa mediante \((p-2)(q-2) < 4\).</li>
                            <li><strong class="text-cyan-400">Modulo 2:</strong> Grupos de simetria -- rotaciones, reflexiones, el teorema orbita-estabilizador, los grupos de los poliedros.</li>
                            <li><strong class="text-cyan-400">Modulo 3:</strong> Dualidad y simbolos de Schlafli -- la notacion \(\{p, q\}\), los pares duales, el tetraedro autodual.</li>
                            <li><strong class="text-cyan-400">Modulo 4:</strong> Dimensiones superiores -- el teseracto, los politopos regulares en 4D, la formula de Euler-Poincare.</li>
                            <li><strong class="text-cyan-400">Modulo 5:</strong> Teoria de grafos -- planaridad, coloracion, hamiltonicidad, espectros laplacianos.</li>
                        </ul>
                        <p class="text-gray-300 mb-4">
                            Los solidos platonicos se situan en la interseccion de la <strong class="text-white">geometria</strong>, el <strong class="text-white">algebra</strong>, la <strong class="text-white">topologia</strong>, la <strong class="text-white">combinatoria</strong> y la <strong class="text-white">computacion</strong>. Son un microcosmos de las matematicas: un punto de partida simple --cinco objetos que un ninio puede construir con papel-- que conecta con teoria profunda.
                        </p>
                        <p class="text-gray-300">
                            Desde la clasificacion geometrica de Euclides hasta el espectro del laplaciano, desde los grupos de simetria hasta los circuitos hamiltonianos, cada perspectiva revela una capa nueva de estructura. Esa es la naturaleza de las matematicas: un objeto simple, mirado desde angulos distintos, genera un universo de conexiones.
                        </p>
                    </section>

                    <!-- Ejercicios -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">Ejercicios</h3>
                        <div class="bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4">
                            <div>
                                <p class="text-gray-300"><strong class="text-white">1.</strong> Construye la matriz laplaciana \(L\) del tetraedro (\(K_4\)). Verifica que el vector de unos \(\mathbf{1} = (1,1,1,1)^T\) es un autovector con autovalor 0, es decir, que \(L\mathbf{1} = \mathbf{0}\).</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">2.</strong> Usa el teorema de Kirchhoff para calcular \(\tau(K_4)\). Elimina la primera fila y columna de \(L\) y calcula el determinante de la matriz \(3 \times 3\) resultante. Verifica que el resultado coincide con la formula de Cayley \(4^2 = 16\).</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">3.</strong> Para el cubo, determina \(\alpha(G)\) y \(\omega(G)\). Exhibe explicitamente un conjunto independiente maximo y un clique maximo. Verifica la desigualdad \(\alpha \cdot \chi \geq V\).</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">4.</strong> Encuentra un arbol de expansion del dodecaedro. Cuantas aristas tiene? Cuantas aristas deben eliminarse del grafo original? Relaciona este ultimo numero con el numero de caras.</p>
                            </div>
                            <div>
                                <p class="text-gray-300"><strong class="text-white">5.</strong> La conectividad algebraica \(\lambda_2\) del tetraedro es 4, mientras que para el dodecaedro es aproximadamente 0.76. Explica intuitivamente por que el tetraedro es "mas conectado" a pesar de tener menos vertices.</p>
                            </div>
                        </div>
                    </section>

                    <!-- LAB -->
                    <section class="mb-10">
                        <h3 class="text-xl font-semibold text-cyan-400 mb-4">LAB: Explorador Espectral</h3>
                        <p class="text-gray-400 mb-4">Selecciona un grafo platonico para visualizar su estructura y su espectro laplaciano. El panel inferior muestra los invariantes espectrales y combinatorios.</p>

                        <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
                            <!-- Controls -->
                            <div class="flex flex-wrap items-center gap-2 px-4 py-3 border-b border-gray-800">
                                <button data-graph="0" class="spec-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/20 text-violet-400 border border-violet-500/30 transition">Tetraedro</button>
                                <button data-graph="1" class="spec-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Cubo</button>
                                <button data-graph="2" class="spec-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Octaedro</button>
                                <button data-graph="3" class="spec-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Dodecaedro</button>
                                <button data-graph="4" class="spec-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition">Icosaedro</button>
                            </div>
                            <!-- Info -->
                            <div class="flex flex-wrap justify-center gap-4 px-4 py-2 border-b border-gray-800 text-sm mono">
                                <span class="text-gray-400">&tau;(G)=<span id="spec-tau" class="text-violet-400">16</span></span>
                                <span class="text-gray-400">&lambda;<sub>2</sub>=<span id="spec-lambda2" class="text-cyan-400">4</span></span>
                                <span class="text-gray-400">&alpha;(G)=<span id="spec-alpha" class="text-violet-400">1</span></span>
                                <span class="text-gray-400">&omega;(G)=<span id="spec-omega" class="text-cyan-400">4</span></span>
                                <span class="text-gray-400">&gamma;(G)=<span id="spec-gamma" class="text-violet-400">1</span></span>
                            </div>
                            <!-- Canvas -->
                            <div id="spec-container" class="w-full bg-black" style="height:480px; position:relative;">
                                <canvas id="spec-canvas" style="position:absolute;top:0;left:0;width:100%;height:100%;"></canvas>
                            </div>
                        </div>
                    </section>

                    <!-- Navigation -->
                    <div class="mt-12 pt-8 border-t border-gray-800 flex justify-between items-center">
                        <a href="./leccion-28.html" class="px-6 py-3 bg-gray-900 hover:bg-gray-800 rounded-lg text-gray-300 transition">
                            &larr; Anterior
                        </a>
                        <a href="../modulo-06/leccion-30.html" class="px-6 py-3 bg-violet-500/10 text-violet-400 hover:bg-violet-500/20 rounded-lg transition">
                            Siguiente: Modulo 6 &rarr;
                        </a>
                    </div>
                </article>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-gray-900 py-6 mt-12">
        <div class="max-w-6xl mx-auto px-6">
            <nav class="text-xs text-gray-600 text-center mb-2">
                <a href="../../../../../_portal/index.html" class="hover:text-violet-400 transition">EigenLab</a>
                <span class="mx-1">/</span>
                <a href="../../../index.html" class="hover:text-violet-400 transition">Math Visual Lab</a>
                <span class="mx-1">/</span>
                <a href="../../index.html" class="hover:text-violet-400 transition">Platonic Lab</a>
                <span class="mx-1">/</span>
                <a href="../index.html" class="hover:text-violet-400 transition">Curso</a>
            </nav>
            <p class="text-center text-gray-700 text-sm mono">Matematicas Visuales -- De Platon a 4D</p>
        </div>
    </footer>

    <script>
    // ============================================================
    // GRAPH DATA for all 5 Platonic solids
    // ============================================================
    var GRAPHS = [
        { name: 'Tetraedro', V: 4, deg: 3, diam: 1, girth: 3,
          edges: [[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]] },
        { name: 'Cubo', V: 8, deg: 3, diam: 3, girth: 4,
          edges: [[0,1],[0,2],[0,4],[1,3],[1,5],[2,3],[2,6],[3,7],[4,5],[4,6],[5,7],[6,7]] },
        { name: 'Octaedro', V: 6, deg: 4, diam: 2, girth: 3,
          edges: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,4],[1,5],[2,3],[2,5],[3,4],[3,5],[4,5]] },
        { name: 'Dodecaedro', V: 20, deg: 3, diam: 5, girth: 5,
          edges: [[0,1],[1,2],[2,3],[3,4],[4,0],
                  [0,5],[1,6],[2,7],[3,8],[4,9],
                  [5,10],[5,14],[6,10],[6,11],[7,11],[7,12],[8,12],[8,13],[9,13],[9,14],
                  [10,15],[11,16],[12,17],[13,18],[14,19],
                  [15,16],[16,17],[17,18],[18,19],[19,15]] },
        { name: 'Icosaedro', V: 12, deg: 5, diam: 3, girth: 3,
          edges: [[0,1],[0,2],[0,3],[0,4],[0,5],
                  [1,2],[2,3],[3,4],[4,5],[5,1],
                  [1,6],[2,6],[2,7],[3,7],[3,8],[4,8],[4,9],[5,9],[5,10],[1,10],
                  [6,7],[7,8],[8,9],[9,10],[10,6],
                  [11,6],[11,7],[11,8],[11,9],[11,10]] }
    ];

    // Spectral data for each platonic graph
    var SPECTRAL = [
        { spectrum: [0, 4, 4, 4], tau: 16, lambda2: 4, alpha: 1, omega: 4, gamma: 1 },
        { spectrum: [0, 2, 2, 2, 4, 4, 4, 6], tau: 384, lambda2: 2, alpha: 4, omega: 2, gamma: 2 },
        { spectrum: [0, 4, 4, 6, 6, 6], tau: 384, lambda2: 4, alpha: 2, omega: 3, gamma: 2 },
        { spectrum: [0, 0.76, 0.76, 0.76, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 5, 5, 5, 5.24, 5.24, 5.24],
          tau: '~6.0\u00d710\u2078', lambda2: 0.764, alpha: 8, omega: 2, gamma: 4 },
        { spectrum: [0, 2.76, 2.76, 2.76, 4, 4, 5, 5, 5, 6, 6, 10],
          tau: '~4.3\u00d710\u2076', lambda2: 2.764, alpha: 3, omega: 3, gamma: 2 }
    ];

    function circularLayout(n, cx, cy, r) {
        var pos = [];
        for (var i = 0; i < n; i++) {
            var a = -Math.PI / 2 + 2 * Math.PI * i / n;
            pos.push([cx + r * Math.cos(a), cy + r * Math.sin(a)]);
        }
        return pos;
    }

    // ============================================================
    // ILLUSTRATION 1: Spanning Tree of the Cube
    // ============================================================
    (function() {
        var c = document.getElementById('spanning-tree-canvas');
        if (!c) return;
        var W = c.clientWidth, H = c.clientHeight;
        var dpr = window.devicePixelRatio || 1;
        c.width = W * dpr; c.height = H * dpr;
        var ctx = c.getContext('2d');
        ctx.scale(dpr, dpr);

        var cube = GRAPHS[1];
        // 3D-ish layout for the cube
        var ox = W / 2, oy = H / 2;
        var s = Math.min(W, H) * 0.25;
        var d = s * 0.55;
        var positions = [
            [ox - s, oy + s * 0.4],         // 0 front-bottom-left
            [ox + s, oy + s * 0.4],         // 1 front-bottom-right
            [ox - s, oy - s * 0.8],         // 2 front-top-left
            [ox + s, oy - s * 0.8],         // 3 front-top-right
            [ox - s + d, oy + s * 0.4 - d], // 4 back-bottom-left
            [ox + s + d, oy + s * 0.4 - d], // 5 back-bottom-right
            [ox - s + d, oy - s * 0.8 - d], // 6 back-top-left
            [ox + s + d, oy - s * 0.8 - d]  // 7 back-top-right
        ];

        // Spanning tree: 0-1, 1-3, 3-2, 2-6, 6-7, 7-5, 5-4
        var treeEdges = [[0,1],[1,3],[3,2],[2,6],[6,7],[5,7],[4,5]];

        function isTreeEdge(a, b) {
            for (var i = 0; i < treeEdges.length; i++) {
                var e = treeEdges[i];
                if ((e[0] === a && e[1] === b) || (e[0] === b && e[1] === a)) return true;
            }
            return false;
        }

        // Draw non-tree edges first (behind)
        for (var i = 0; i < cube.edges.length; i++) {
            var a = cube.edges[i][0], b = cube.edges[i][1];
            if (isTreeEdge(a, b)) continue;
            ctx.beginPath();
            ctx.moveTo(positions[a][0], positions[a][1]);
            ctx.lineTo(positions[b][0], positions[b][1]);
            ctx.strokeStyle = 'rgba(107, 114, 128, 0.25)';
            ctx.lineWidth = 1.5;
            ctx.setLineDash([5, 4]);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        // Draw tree edges on top
        for (var i = 0; i < cube.edges.length; i++) {
            var a = cube.edges[i][0], b = cube.edges[i][1];
            if (!isTreeEdge(a, b)) continue;
            ctx.beginPath();
            ctx.moveTo(positions[a][0], positions[a][1]);
            ctx.lineTo(positions[b][0], positions[b][1]);
            ctx.strokeStyle = 'rgba(34, 211, 238, 0.85)';
            ctx.lineWidth = 3;
            ctx.stroke();
        }

        // Draw vertices
        for (var i = 0; i < 8; i++) {
            ctx.beginPath();
            ctx.arc(positions[i][0], positions[i][1], 10, 0, Math.PI * 2);
            ctx.fillStyle = '#a78bfa';
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = '11px "JetBrains Mono", monospace';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('' + i, positions[i][0], positions[i][1]);
        }

        // Legend
        ctx.fillStyle = '#22d3ee';
        ctx.font = '12px Inter, sans-serif';
        ctx.textAlign = 'left';
        ctx.fillText('Arbol (7 aristas)', 20, H - 36);
        ctx.beginPath();
        ctx.moveTo(140, H - 36);
        ctx.lineTo(180, H - 36);
        ctx.strokeStyle = 'rgba(34, 211, 238, 0.85)';
        ctx.lineWidth = 3;
        ctx.stroke();

        ctx.fillStyle = '#6b7280';
        ctx.fillText('Eliminadas (5)', 20, H - 16);
        ctx.beginPath();
        ctx.moveTo(140, H - 16);
        ctx.lineTo(180, H - 16);
        ctx.strokeStyle = 'rgba(107, 114, 128, 0.25)';
        ctx.lineWidth = 1.5;
        ctx.setLineDash([5, 4]);
        ctx.stroke();
        ctx.setLineDash([]);
    })();

    // ============================================================
    // ILLUSTRATION 2: Laplacian Spectrum Bar Chart (Tetrahedron)
    // ============================================================
    (function() {
        var c = document.getElementById('spectrum-canvas');
        if (!c) return;
        var W = c.clientWidth, H = c.clientHeight;
        var dpr = window.devicePixelRatio || 1;
        c.width = W * dpr; c.height = H * dpr;
        var ctx = c.getContext('2d');
        ctx.scale(dpr, dpr);

        var spectrum = [0, 4, 4, 4];
        var maxVal = 5;
        var n = spectrum.length;
        var pad = { left: 60, right: 30, top: 30, bottom: 40 };
        var plotW = W - pad.left - pad.right;
        var plotH = H - pad.top - pad.bottom;
        var barW = Math.min(50, plotW / n * 0.6);
        var gap = (plotW - barW * n) / (n + 1);

        // Axes
        ctx.strokeStyle = '#374151';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(pad.left, pad.top);
        ctx.lineTo(pad.left, pad.top + plotH);
        ctx.lineTo(pad.left + plotW, pad.top + plotH);
        ctx.stroke();

        // Y-axis ticks
        ctx.fillStyle = '#9ca3af';
        ctx.font = '11px "JetBrains Mono", monospace';
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for (var v = 0; v <= maxVal; v++) {
            var y = pad.top + plotH - (v / maxVal) * plotH;
            ctx.fillText('' + v, pad.left - 8, y);
            ctx.beginPath();
            ctx.moveTo(pad.left, y);
            ctx.lineTo(pad.left + plotW, y);
            ctx.strokeStyle = 'rgba(55, 65, 81, 0.5)';
            ctx.lineWidth = 0.5;
            ctx.stroke();
        }

        // Bars
        for (var i = 0; i < n; i++) {
            var x = pad.left + gap + i * (barW + gap);
            var barH = (spectrum[i] / maxVal) * plotH;
            var y = pad.top + plotH - barH;

            var grad = ctx.createLinearGradient(x, y, x, pad.top + plotH);
            grad.addColorStop(0, '#a855f7');
            grad.addColorStop(1, '#22d3ee');
            ctx.fillStyle = grad;
            if (barH > 1) {
                ctx.fillRect(x, y, barW, barH);
            } else {
                ctx.fillStyle = '#22d3ee';
                ctx.fillRect(x, pad.top + plotH - 2, barW, 2);
            }

            // Value on top
            ctx.fillStyle = '#e5e7eb';
            ctx.font = '12px "JetBrains Mono", monospace';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'bottom';
            ctx.fillText('' + spectrum[i], x + barW / 2, y - 4);

            // Index label
            ctx.fillStyle = '#9ca3af';
            ctx.font = '11px "JetBrains Mono", monospace';
            ctx.textBaseline = 'top';
            ctx.fillText('\u03BB' + (i + 1), x + barW / 2, pad.top + plotH + 8);
        }

        // Y-axis label
        ctx.save();
        ctx.translate(14, pad.top + plotH / 2);
        ctx.rotate(-Math.PI / 2);
        ctx.fillStyle = '#9ca3af';
        ctx.font = '12px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('Autovalor', 0, 0);
        ctx.restore();
    })();

    // ============================================================
    // LAB: Spectral Explorer
    // ============================================================
    (function() {
        var container = document.getElementById('spec-container');
        var canvas = document.getElementById('spec-canvas');
        if (!container || !canvas) return;

        var W, H, dpr, ctx;
        var currentGraph = 0;
        var positions = [];

        function resize() {
            W = container.clientWidth;
            H = container.clientHeight;
            dpr = window.devicePixelRatio || 1;
            canvas.width = W * dpr;
            canvas.height = H * dpr;
            ctx = canvas.getContext('2d');
            ctx.scale(dpr, dpr);
        }

        function initPositions() {
            var g = GRAPHS[currentGraph];
            var graphAreaW = W * 0.45;
            var cx = graphAreaW / 2 + 20;
            var cy = H / 2;
            var r = Math.min(graphAreaW, H) / 2 - 50;
            positions = circularLayout(g.V, cx, cy, r);
        }

        function draw() {
            ctx.clearRect(0, 0, W, H);
            var g = GRAPHS[currentGraph];
            var sp = SPECTRAL[currentGraph];

            // === LEFT HALF: Graph ===
            var graphAreaW = W * 0.45;

            // Title
            ctx.fillStyle = '#9ca3af';
            ctx.font = '13px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(g.name, graphAreaW / 2 + 20, 24);

            // Edges
            ctx.strokeStyle = 'rgba(107, 114, 128, 0.4)';
            ctx.lineWidth = g.V > 12 ? 0.8 : 1.2;
            for (var i = 0; i < g.edges.length; i++) {
                var a = g.edges[i][0], b = g.edges[i][1];
                ctx.beginPath();
                ctx.moveTo(positions[a][0], positions[a][1]);
                ctx.lineTo(positions[b][0], positions[b][1]);
                ctx.stroke();
            }

            // Vertices
            var vr = g.V <= 8 ? 10 : (g.V <= 12 ? 8 : 5);
            for (var i = 0; i < g.V; i++) {
                ctx.beginPath();
                ctx.arc(positions[i][0], positions[i][1], vr, 0, Math.PI * 2);
                ctx.fillStyle = '#a78bfa';
                ctx.fill();
                if (g.V <= 12) {
                    ctx.fillStyle = '#fff';
                    ctx.font = (g.V <= 8 ? '11' : '9') + 'px "JetBrains Mono", monospace';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText('' + i, positions[i][0], positions[i][1]);
                }
            }

            // === RIGHT HALF: Spectrum Bar Chart ===
            var specLeft = graphAreaW + 30;
            var specW = W - specLeft - 30;
            var spectrum = sp.spectrum;
            var n = spectrum.length;
            var maxVal = Math.ceil(Math.max.apply(null, spectrum)) + 1;

            var pad = { left: 40, right: 10, top: 50, bottom: 50 };
            var plotW = specW - pad.left - pad.right;
            var plotH = H - pad.top - pad.bottom;
            var barW = Math.max(4, Math.min(30, plotW / n * 0.65));
            var gap = (plotW - barW * n) / (n + 1);

            // Title
            ctx.fillStyle = '#9ca3af';
            ctx.font = '13px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Espectro Laplaciano', specLeft + specW / 2, 24);

            var ox = specLeft + pad.left;
            var oy = pad.top;

            // Axes
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(ox, oy);
            ctx.lineTo(ox, oy + plotH);
            ctx.lineTo(ox + plotW, oy + plotH);
            ctx.stroke();

            // Y ticks
            ctx.fillStyle = '#6b7280';
            ctx.font = '10px "JetBrains Mono", monospace';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            var step = maxVal <= 6 ? 1 : 2;
            for (var v = 0; v <= maxVal; v += step) {
                var y = oy + plotH - (v / maxVal) * plotH;
                ctx.fillText('' + v, ox - 6, y);
                ctx.beginPath();
                ctx.moveTo(ox, y);
                ctx.lineTo(ox + plotW, y);
                ctx.strokeStyle = 'rgba(55, 65, 81, 0.4)';
                ctx.lineWidth = 0.5;
                ctx.stroke();
            }

            // Bars
            for (var i = 0; i < n; i++) {
                var x = ox + gap + i * (barW + gap);
                var barH = (spectrum[i] / maxVal) * plotH;
                var y = oy + plotH - barH;

                var grad = ctx.createLinearGradient(x, y, x, oy + plotH);
                grad.addColorStop(0, '#a855f7');
                grad.addColorStop(1, '#22d3ee');
                ctx.fillStyle = grad;
                if (barH > 1) {
                    ctx.fillRect(x, y, barW, barH);
                } else {
                    // Zero eigenvalue: draw a small marker
                    ctx.fillStyle = '#22d3ee';
                    ctx.fillRect(x, oy + plotH - 2, barW, 2);
                }

                // Value on top (only if not too many bars)
                if (n <= 12) {
                    ctx.fillStyle = '#d1d5db';
                    ctx.font = '9px "JetBrains Mono", monospace';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    var label = spectrum[i] % 1 === 0 ? '' + spectrum[i] : spectrum[i].toFixed(2);
                    ctx.fillText(label, x + barW / 2, y - 3);
                }
            }

            // X-axis label
            ctx.fillStyle = '#6b7280';
            ctx.font = '11px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            ctx.fillText('Autovalores ordenados', specLeft + specW / 2, oy + plotH + 20);

            // Y-axis label
            ctx.save();
            ctx.translate(specLeft + 12, oy + plotH / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillStyle = '#6b7280';
            ctx.font = '11px Inter, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Magnitud', 0, 0);
            ctx.restore();

            // Divider line
            ctx.beginPath();
            ctx.moveTo(graphAreaW + 15, 10);
            ctx.lineTo(graphAreaW + 15, H - 10);
            ctx.strokeStyle = 'rgba(55, 65, 81, 0.5)';
            ctx.lineWidth = 1;
            ctx.stroke();
        }

        function updateInfo() {
            var sp = SPECTRAL[currentGraph];
            document.getElementById('spec-tau').textContent = sp.tau;
            document.getElementById('spec-lambda2').textContent = typeof sp.lambda2 === 'number' ? (sp.lambda2 % 1 === 0 ? sp.lambda2 : sp.lambda2.toFixed(3)) : sp.lambda2;
            document.getElementById('spec-alpha').textContent = sp.alpha;
            document.getElementById('spec-omega').textContent = sp.omega;
            document.getElementById('spec-gamma').textContent = sp.gamma;
        }

        // Button events
        var btns = document.querySelectorAll('.spec-btn');
        btns.forEach(function(btn) {
            btn.addEventListener('click', function() {
                currentGraph = parseInt(this.getAttribute('data-graph'));
                btns.forEach(function(b) {
                    b.className = 'spec-btn px-3 py-1.5 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-400 hover:text-violet-400 transition';
                });
                this.className = 'spec-btn px-3 py-1.5 rounded-lg text-sm bg-violet-500/20 text-violet-400 border border-violet-500/30 transition';
                initPositions();
                updateInfo();
                draw();
            });
        });

        // Init
        resize();
        initPositions();
        updateInfo();
        draw();
        window.addEventListener('resize', function() { resize(); initPositions(); draw(); });
    })();
    </script>
</body>
</html>
